<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | NormalMapFormats    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">NormalMapFormats  </b></div>
<div id="tooltext">
<a href="NormalMapFormatsJP.html" class="twikiLink">日本語訳</a><br><a href="NormalMapFormatsCH.html" class="twikiLink">中国翻译</a><br><a href="NormalMapFormatsKR.html" class="twikiLink">한국어</a><br>

<!-- Three/NormalMapFormats -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="MaterialsAndTexturesHome.html" class="twikiLink">Materials &amp; Textures</a></b> &gt; Normal Map Formats <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="TextureArtistHome.html" class="twikiLink">Texture Artist</a></b> &gt; Normal Map Formats
</div>
<hr size="1" noshade="noshade">
<h1><a name="Normal Map Formats"></a> Normal Map Formats </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="NormalMapFormats.html#Normal Map Formats"> Normal Map Formats</a> <ul>
<li> <a href="NormalMapFormats.html#Overview"> Overview</a>
</li> <li> <a href="NormalMapFormats.html#Normal formats"> Normal formats</a> <ul>
<li> <a href="NormalMapFormats.html#TC_Normalmap / DXT1"> TC_Normalmap / DXT1</a>
</li> <li> <a href="NormalMapFormats.html#TC_NormalmapAlpha / DXT5"> TC_NormalmapAlpha / DXT5</a>
</li> <li> <a href="NormalMapFormats.html#TC_NormalmapUncompressed / V8U8"> TC_NormalmapUncompressed / V8U8</a>
</li> <li> <a href="NormalMapFormats.html#TC_NormalmapBC5 / BC5 (3Dc / DXN)"> TC_NormalmapBC5 / BC5 (3Dc / DXN) </a>
</li></ul>
</li> <li> <a href="NormalMapFormats.html#Material Editor Usage Notes"> Material Editor Usage Notes</a> <ul>
<li> <a href="NormalMapFormats.html#TextureSample node"> TextureSample node</a>
</li> <li> <a href="NormalMapFormats.html#TextureSampleParameter2D node"> TextureSampleParameter2D node</a>
</li> <li> <a href="NormalMapFormats.html#TextureSampleParameterNormal node"> TextureSampleParameterNormal node</a>
</li></ul>
</li> <li> <a href="NormalMapFormats.html#Recommendations"> Recommendations</a>
</li> <li> <a href="NormalMapFormats.html#External Links"> External Links</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Since version QA_APPROVED_BUILD_SEP_2009, the engine has supported a number of normal map formats. This document describes the advantages and disadvantages of each format, and how to use the Normal Parameter material node.
<p />
<h2><a name="Normal formats"></a> Normal formats </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
This table summarizes the features of the various normal formats.
<p />
<table cellspacing="1" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> CompressionSettings </td><td bgcolor="#eaeaea"> Texture Format </td><td bgcolor="#eaeaea"> Channels </td><td bgcolor="#eaeaea"> Bits per Pixel </td><td bgcolor="#eaeaea"> Size for 1024x1024 </td><td bgcolor="#eaeaea"> Comments </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> TC_Normalmap </td><td bgcolor="#ffffff"> DXT1 </td><td bgcolor="#ffffff"> 3(*) </td><td bgcolor="#ffffff"> 4 </td><td bgcolor="#ffffff"> 512 KB </td><td bgcolor="#ffffff"> * It is possible to store 1-bit alpha (mask) in the alpha channel of DXT1 </td></tr>
<tr><td bgcolor="#eaeaea" class="twikiFirstCol"> TC_NormalmapAlpha </td><td bgcolor="#eaeaea"> DXT5 </td><td bgcolor="#eaeaea"> 4 </td><td bgcolor="#eaeaea"> 8 </td><td bgcolor="#eaeaea"> 1024 KB </td><td bgcolor="#eaeaea"> &nbsp; </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> TC_NormalmapUncompressed </td><td bgcolor="#ffffff"> V8U8 </td><td bgcolor="#ffffff"> 2 </td><td bgcolor="#ffffff"> 16 </td><td bgcolor="#ffffff"> 2048 KB </td><td bgcolor="#ffffff"> Because the memory usage is 4x that of DXT1, the engine automatically reduces the resolution by one mip-map, to match the DXT1 footprint </td></tr>
<tr><td bgcolor="#eaeaea" class="twikiFirstCol"> TC_NormalmapBC5 </td><td bgcolor="#eaeaea"> BC5 (3Dc / DXN) </td><td bgcolor="#eaeaea"> 2 </td><td bgcolor="#eaeaea"> 8 </td><td bgcolor="#eaeaea"> 1024 KB </td><td bgcolor="#eaeaea"> Supported on DirectX 10 and Xbox 360, or on ATI cards under DirectX 9 </td></tr>
</table>
<p />
<h3><a name="TC_Normalmap / DXT1"></a> TC_Normalmap / DXT1 </h3>
<img src="rsrc/Three/NormalMapFormats/Normal_DXT15.png" alt="Normal_DXT15.png" width='789' height='688' />
<p />
TC_Normalmap (DXT1) has the smallest memory usage of any of the formats, but the DXT block compression is not very well suited to storing normal data. The result is typically very blocky.
<p />
<h3><a name="TC_NormalmapAlpha / DXT5"></a> TC_NormalmapAlpha / DXT5 </h3>
<p />
TC_NormalmapAlpha (DXT5) has identical visual results to DXT1 but also has 4-bits per pixel of compressed alpha channel data to use as a mask. It's better for performance to put a mask you need in a DXT5 texture, rather than sample another texture. But if you put the mask into the diffuse texture, it would allow you to use another format for the normal.
<p />
<h3><a name="TC_NormalmapUncompressed / V8U8"></a> TC_NormalmapUncompressed / V8U8 </h3>
<img src="rsrc/Three/NormalMapFormats/Normal_Uncompressed.png" alt="Normal_Uncompressed.png" width='789' height='688' />
<p />
The uncompressed format stores two of the normal's 3 channels in 8 bits each (so 16 bits per pixel). This is the highest quality but because only two channels are stored, the Z needs to be calculated in the pixel shader. (The material editor does this automatically, note the increased instruction count in the screenshot above).
<p />
Because the memory usage is 4x that of DTX1, reducing the X and Y resolutions by half (ie 1 mip level) will make the memory usage identical.  We believe that half-resolution uncompressed normals look better than DXT1 compressed normals, so <strong>the texture editor automatically reduces the resolution when choosing TC_NormalmapUncompressed format</strong>. The texture's original resolution is restored when changing back to another format.
<p />
(This code is in UTexture2D::Compress() should you wish to remove or disable this functionality)
<p />
<h3><a name="TC_NormalmapBC5 / BC5 (3Dc / DXN)"></a> TC_NormalmapBC5 / BC5 (3Dc / DXN) </h3>
<img src="rsrc/Three/NormalMapFormats/Normal_BC5.png" alt="Normal_BC5.png" width='789' height='688' />
<p />
The BC5 format, otherwise known as 3Dc or DXN is not supported on all platforms- only DirectX 10, Xbox 360 and also under DirectX 9 on ATI graphic cards. For the normal's X and Y vectors it uses a 4 bit-per-pixel block compression scheme similar to that of the alpha channel on DXT5, meaning the channels are independent of each other. This gives a much less blocky result with the same memory footprint as DXT5. Like the uncompressed format, the Z is derived in the pixel shader.
<p />
<h2><a name="Material Editor Usage Notes"></a> Material Editor Usage Notes </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Because some of the formats require that the Z channel be reconstructed in the pixel shader, using a texture of a different format requires different pixel shader code. The material editor handles this for you, but there are some pitfalls to be aware of.
<p />
<h3><a name="TextureSample node"></a><a name="_TextureSample node"></a> TextureSample node </h3>
<p />
Using a normal of any format inside a TextureSample node will work correctly. However, the normal format is only checked when the material's shaders are recompiled. So if you change the normal texture's CompressionSettings without recompiling shaders, the pixel shader code generated might not match. This is similar to the behavior of UnpackMin/Max.
<p />
<h3><a name="TextureSampleParameter2D node"></a><a name="_TextureSampleParameter2D node"></a> TextureSampleParameter2D node </h3>
<p />
Using a normal of any format inside the default value of a TextureSampleParameter2D node will work correctly. However, any material instance that overrides the default value <strong>must have the same CompressionSettings as the default Texture property</strong> of the parameter. Like TextureSample, the same warning about changing the default texture's CompressionSettings without recompiling shaders applies.
<p />
<h3><a name="TextureSampleParameterNormal node"></a><a name="_TextureSampleParameterNormal node"></a> TextureSampleParameterNormal node </h3>
<p />
<img src="rsrc/Three/NormalMapFormats/NormalParam.png" alt="NormalParam.png" width='367' height='143' />
<p />
Using a normal of any format inside the default value of a TextureSampleParameterNormal node will work correctly, and also any constant instance created in the Material Instance Editor can override the normal parameter with a texture of any format. If the formats require different pixel shaders, a new version for the instance will be recompiled.
<p />
But like TextureSample, the same warning about changing a texture's CompressionSettings without recompiling shaders applies.
<p />
<h2><a name="Recommendations"></a> Recommendations </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p /> <ul>
<li> Use TC_NormalmapUncompressed with reduced-resolution instead of TC_Normalmap, if it looks better for your content. The memory usage is the same.
</li> <li> Use TC_NormalmapBC5 if you are making an Xbox 360 game and you feel the quality difference compared to reduced-resolution TC_NormalmapUncompressed is worth the 2x memory size increase.
</li> <li> It is recommended you use the TextureSampleParameterNormal material node whenever you need to use a normal map as a parameter.
</li> <li> You should be consistent with the normal map formats you use with a particular material instance parent, to reduce the number of shaders generated.
</li></ul>
<p />
<h2><a name="External Links"></a> External Links </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p /> <ul>
<li> <a href="http://www.gamasutra.com/view/feature/2496/texture_compression_techniques_and_.php" target="_top">http://www.gamasutra.com/view/feature/2496/texture_compression_techniques_and_.php</a>
</li> <li> <a href="http://download.nvidia.com/developer/Papers/2004/Bump_Map_Compression/Bump_Map_Compression.pdf" target="_top">http://download.nvidia.com/developer/Papers/2004/Bump_Map_Compression/Bump_Map_Compression.pdf</a>
</li> <li> <a href="http://ati.amd.com/developer/NormalMapCompression.pdf" target="_top">http://ati.amd.com/developer/NormalMapCompression.pdf</a>
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
