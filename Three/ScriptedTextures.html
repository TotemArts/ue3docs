<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | ScriptedTextures    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">ScriptedTextures  </b></div>
<div id="tooltext">
<a href="ScriptedTexturesJP.html" class="twikiLink">日本語訳</a><br><a href="ScriptedTexturesCH.html" class="twikiLink">中国翻译</a><br><a href="ScriptedTexturesKR.html" class="twikiLink">한국어</a><br>

<!-- Three/ScriptedTextures -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="RenderingHome.html" class="twikiLink">Rendering</a></b> &gt; Scripted Texture <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="UnrealScriptHome.html" class="twikiLink">UnrealScript</a></b> &gt; Scripted Texture
</div>
<hr size="1" noshade="noshade">
<h1><a name="Scripted Texture"></a> Scripted Texture </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="ScriptedTextures.html#Scripted Texture">  Scripted Texture</a> <ul>
<li> <a href="ScriptedTextures.html#Overview"> Overview</a>
</li> <li> <a href="ScriptedTextures.html#ScriptedTexture Class"> ScriptedTexture Class</a>
</li> <li> <a href="ScriptedTextures.html#ScriptedTexture Setup"> ScriptedTexture Setup</a> <ul>
<li> <a href="ScriptedTextures.html#ScriptedTexture Creation"> ScriptedTexture Creation</a>
</li> <li> <a href="ScriptedTextures.html#Assigning _ScriptedTexture"> Assigning ScriptedTexture</a>
</li> <li> <a href="ScriptedTextures.html#Render Delegate"> Render Delegate</a>
</li></ul>
</li> <li> <a href="ScriptedTextures.html#ScriptedTexture Example"> ScriptedTexture Example</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Scripted textures allow arbitrary drawing to a texture during runtime from UnrealScript. This drawing is done through the use of a Canvas and the functionality it contains. This means text, materials, other textures, etc. can all be drawn to the scripted texture.
<p />
This functionality could be used for anything you can imagine. Some examples might be drawing the players names on their uniforms in a sports game, leaderboards displayed on surfaces in the world, displaying a live feed of text from an external source obtained through a TCPLink or DLLBind source, or even something as complex as allowing the player to paint directly on a surface inside of the game.
<p />
<h2><a name="ScriptedTexture Class"></a> ScriptedTexture Class </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
The ScriptedTexture class is extended from the TextureRenderTarget2D class. It has the following important members:
<p />
<strong>Properties</strong>
<p /> <ul>
<li> <strong>Size[X/Y]</strong> - The dimensions of the texture in the horizontal and vertical directions, respectively. Inherited from <code>TextureRenderTarget2D</code>.
</li> <li> <strong>Format</strong> - The <code>EPixelFormat</code> format of the texture data. Inherited from <code>TextureRenderTarget2D</code>.
</li> <li> <strong>ClearColor</strong> - The <code>LinearColor</code> used to clear the texture to. Inherited from <code>TextureRenderTarget2D</code>.
</li> <li> <strong>bNeedsUpdate</strong> - If true, the <code>Render()</code> delegate will be called at the end of the tick, just before all other rendering.
</li> <li> <strong>bSkipNextClear</strong> - If true, the texture will not be cleared before the next call of the <code>Render()</code> delegate. This is useful if you want to draw to the texture over multiple frames.
</li></ul>
<p />
<strong>Functions</strong>
<p /> <ul>
<li> <strong>Create [InSizeX] [InSizeY] [InFormat] [InClearColor] [bOnlyRenderOnce]</strong> - Static. Creates a new TextureRenderTarget2D using the specified parameters. Inherited from <code>TextureRenderTarget2D</code>. <ul>
<li> <strong>InSizeX</strong> - Sets the size of the new texture in the horizontal direction.
</li> <li> <strong>InSizeY</strong> - Sets the size of the new texture in the vertical direction.
</li> <li> <strong>InFormat</strong> - Optional. Sets the <code>EPixelFormat</code> used by the texture.
</li> <li> <strong>InClearColor</strong> - Optional. Sets the <code>LinearColor</code> to clear texture to.
</li> <li> <strong>bOnlyRenderOnce</strong> - Optional. If true, the texture will only update a single time, the first frame it is created.
</li></ul>
</li> <li> <strong>Render [C]</strong> - The delegate called to draw to the texture. <ul>
<li> <strong>C</strong> - The Canvas object used to draw to the texture for the current frame.
</li></ul>
</li></ul>
<p />
<h2><a name="ScriptedTexture Setup"></a> ScriptedTexture Setup </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
In order to create and use a ScriptedTexture, there are some steps to perform that may not be immediately obvious. The main points will be detailed here to get you on your way to using ScriptedTextures in your game.
<p />
<h3><a name="ScriptedTexture Creation"></a> ScriptedTexture Creation </h3>
<p />
First, a new ScriptedTexture must be created in your class. The <code>Create()</code> function is used for this, though it may not be obvious how to use it since it returns a <code>TextureRenderTarget2D</code>.
<p />
<div style="padding:1px 10px 5px 10px;background:#e0e0e0;">
<pre>
var ScriptedTexture CanvasTexture;

...

CanvasTexture &#61; ScriptedTexture(class&#39;ScriptedTexture&#39;.static.Create(1024, 1024,, ClearColor));
</pre>
</div>
<p />
The <code>Create()</code> static function is called from the ScriptedTexture class and then cast to a Scriptedtexture. This can then be assigned to a ScriptedTexture variable to reference the new ScriptedTexture.
<p />
<h3><a name="Assigning _ScriptedTexture"></a> Assigning ScriptedTexture </h3>
<p />
Once the ScriptedTexture is created, it needs to be assigned to a Material in order to be used. This requires a little setup in UnrealEd as we need a Material with a TextureSampleParameter2D expression we can assign the ScriptedTexture to.
<p />
<img src="rsrc/Three/ScriptedTextures/ex_material_param.jpg" width="800" height="315" alt="ex_material_param.jpg" />
<p />
<div style="padding:1px 10px 5px 10px;background:#e0e0e0;">
<pre>
var StaticMeshCompeonent Mesh; //Mesh used to display the material in-game
var MaterialInstanceConstant CanvasMaterial; //new material instance to assign ScriptedTexture to
var MaterialInterface CanvasMaterialTemplate; //Material created in UnrealEd with TextureSampleParameter2D
var Int CanvasMaterialIndex; //Index of material on mesh to assign new Material to
var Name CanvasMaterialParameterName; //Name of TextureSampleParameter2D in CanvasMaterialTemplate

...

CanvasMaterial &#61; Mesh.CreateAndSetMaterialInstanceConstant(CanvasMaterialIndex);
if(CanvasMaterial !&#61; none)
{
   CanvasMaterial.SetParent(CanvasMaterialTemplate);

   if(CanvasMaterialParameterName !&#61; &#39;&#39;)
   {
      CanvasMaterial.SetTextureParameterValue(CanvasMaterialParameterName, CanvasTexture);
   }
}
</pre>
</div>
<p />
A new MaterialInsatnceConstant is created and assigned to the static mesh. Then the parent of that material instance is set to the CanvasMaterialTemplate, which should reference the template material that has the texture parameter set up to receive the ScriptedTexture. Finally, the ScriptedTexture is assigned to the texture parameter.
<p />
<h3><a name="Render Delegate"></a> Render Delegate </h3>
<p />
With the ScriptedTexture all set up and being displayed, the last step is to draw to the texture. This requires assigning a function to the <code>Render()</code> delegate of the ScriptedTexture. Then, inside the drawing function, standard Canvas drawing commands can be used to draw to the ScriptedTexture.
<p />
<div style="padding:1px 10px 5px 10px;background:#e0e0e0;">
<pre>
CanvasTexture.Render &#61; OnRender;

...

function OnRender(Canvas C)
{
   ...Drawing Commands...
}
</pre>
</div>
<p />
<h2><a name="ScriptedTexture Example"></a> ScriptedTexture Example </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
This example shows a complete implementation of a ScriptedTexture which will display a horizontally scrolling piece of text on a mesh in-game. Of course, the example only displays one string over and over, but it has the ability to take in a new string. This could be extended to take in a new string of text and add it to a buffer array in order to display an ongoing stream of text, such as that of an IRC chat room.
<p />
The main points of interest are the <code>PostBeginPlay()</code> and <code>ConsoleRender()</code> as those handle the setup and rendering of the ScriptedTexture, respectively.
<p />
<img src="rsrc/Three/ScriptedTextures/scriptedtexture_preview.gif" width="564" height="232" alt="scriptedtexture_preview.gif" />
<p />
<code>TextConsole.uc</code>
<div style="padding:1px 10px 5px 10px;background:#e0e0e0;">
<pre>
class TextConsole extends Actor placeable;

var() int ConsoleMaterialIndex;
var() MaterialInterface ConsoleMaterialTemplate;
var() name CanvasTextureParamName;

var MaterialInstanceConstant ConsoleMaterial;
var ScriptedTexture CanvasTexture;
var() float ScrollAmount;
var() float TextScale;
var() LinearColor ClearColor;
var() Color TextColor;

var string ConsoleText;
var Vector2D Pos;

var() editinline const StaticMeshComponent Mesh;

function PostBeginPlay()
{
   super.PostBeginPlay();

   CanvasTexture &#61; ScriptedTexture(class&#39;ScriptedTexture&#39;.static.Create(1024, 1024,, ClearColor));
   CanvasTexture.Render &#61; OnRender;

   if(ConsoleMaterialTemplate !&#61; none)
   {
      ConsoleMaterial &#61; Mesh.CreateAndSetMaterialInstanceConstant(ConsoleMaterialIndex);
      if(ConsoleMaterial !&#61; none)
      {
         ConsoleMaterial.SetParent(ConsoleMaterialTemplate);

         if(CanvasTextureParamName !&#61; &#39;&#39;)
         {
            ConsoleMaterial.SetTextureParameterValue(CanvasTextureParamName, CanvasTexture);
         }
      }
   }

   SetConsoleText(&#34;Console Display Text&#34;);
   Pos.X &#61; CanvasTexture.SizeX;
}

function SetConsoleText(string text)
{
   ConsoleText &#61; text;
}

function OnRender(Canvas C)
{
   local Vector2D TextSize;

   C.TextSize(ConsoleText, TextSize.X, TextSize.Y);
   TextSize &#42;&#61; TextScale;
   Pos.Y &#61; (CanvasTexture.SizeY / 2) - (TextSize.Y / 2);
   Pos.X -&#61; WorldInfo.DeltaSeconds &#42; ScrollAmount;
   if(Pos.X &#60; -TextSize.X)
   {
      Pos.X &#61; CanvasTexture.SizeX;
   }

   C.SetOrigin(0,0);
   C.SetClip(CanvasTexture.SizeX + TextSize.X, CanvasTexture.SizeY + TextSize.Y);
   C.SetPos(Pos.X, Pos.Y);

   C.SetDrawColorStruct(TextColor);

   C.DrawText(ConsoleText,, TextScale, TextScale);

   CanvasTexture.bNeedsUpdate &#61; true;
}

defaultproperties
{
   ClearColor&#61;(R&#61;0.0,G&#61;0.0,B&#61;0.0,A&#61;0.0)
   TextColor&#61;(R&#61;255,G&#61;255,B&#61;255,A&#61;255)
   ScrollAmount&#61;150.0
   TextScale&#61;1.0

   Begin Object class&#61;StaticMeshComponent Name&#61;StaticMeshComp1
      StaticMesh&#61;StaticMesh&#39;dwStaticMeshes.Plane&#39;
   End Object

   Mesh &#61; StaticMeshComp1
   Components.Add(StaticMeshComp1)
}
</pre>
</div>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
