<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | SpeedTree    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">SpeedTree  </b></div>
<div id="tooltext">
<a href="SpeedTreeJP.html" class="twikiLink">日本語訳</a><br><a href="SpeedTreeCH.html" class="twikiLink">中国翻译</a><br><a href="SpeedTreeKR.html" class="twikiLink">한국어</a><br>

<!-- Three/SpeedTree -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<h1><a name="Speed Tree"></a> Speed Tree </h1>
<p />
<em>Document Summary: How to use SpeedTree Actors in the editor,  This document has been updated with Speedtree5 information.</em>
<p />
<em>Document Changelog: Created by <a href="https://udn.epicgames.com/Main/DanielWright" class="restricted" class="restricted" class="twikiLink">Daniel Wright</a>.</em>
<p />
<div class="twikiToc"> <ul>
<li> <a href="SpeedTree.html#Speed Tree"> Speed Tree</a> <ul>
<li> <a href="SpeedTree.html#Broad Concepts"> Broad Concepts</a> <ul>
<li> <a href="SpeedTree.html#Atlases"> Atlases</a>
</li> <li> <a href="SpeedTree.html#Leaves"> Leaves</a>
</li> <li> <a href="SpeedTree.html#Branches"> Branches</a>
</li></ul>
</li> <li> <a href="SpeedTree.html#Compiling"> Compiling</a>
</li> <li> <a href="SpeedTree.html#LODs"> LODs</a> <ul>
<li> <a href="SpeedTree.html#LOD setup in the Modeler"> LOD setup in the Modeler</a>
</li> <li> <a href="SpeedTree.html#LOD setup in the Compiler"> LOD setup in the Compiler</a>
</li> <li> <a href="SpeedTree.html#LOD setup in UE3"> LOD setup in UE3</a>
</li></ul>
</li></ul>
</li></ul>
</div>
<p />
<p />
<noautolink>
<p />
<h2><a name="Broad Concepts"></a> Broad Concepts </h2>
<p />
There are 3 components to Speedtree 5.0: the SpeedTree Modeler, SpeedTree Compiler and the integration into the UE3 game/editor. In the modeler you iterate on the tree's shape, wind and collision. The modeler renders using an external application and may not match up with what you get in UE3. The modeler exports .SPM files, which can only be read by the compiler. The compiler takes the .SPM file and generates texture atlases, vertex data and other information about the tree. It saves everything but the textures into a .SRT file, which is what you import into UE3.
<p />
<strong>For artists: Be sure to read the documentation from IDV</strong> at: <br />
%speedtree apps folder%/Content/Tools/5.0/SpeedTree_Applications_v5.0_Full/Documentation
<p />
For programmers: Be sure to read the Speedtree SDK documentation from IDV.
<p />
<h3><a name="Atlases"></a> Atlases </h3>
<p />
Speedtree likes to combine all textures onto an atlas. This works best for our games if we only combine the billboard images onto an atlas. This allows us to share leaf and trunk textures across multiple trees to save memory.  If you want you can create your own atlas in Photoshop of bark and leaves that can be shared across multiple trees, just skip the Atlas generation step in the compiler.
<p />
<h3><a name="Leaves"></a> Leaves </h3>
<p />
Speedtrees support using billboards as leaves but this isn't very effective, it looks much better to define a mesh as a group of leaves or a branch.
<p />
<h3><a name="Branches"></a> Branches </h3>
<p />
Branches look better and run better if they are meshes rather than the frond type mesh that uses masked materials. Using the meshes reduces overdraw and can be optimized out at distances.
<p />
<p />
<h2><a name="Compiling"></a> Compiling </h2>
<p />
Compiling is fairly straightforward. Load your speedtree. Don't create a texture atlas but do create a billboard atlas. Select finish. In the left window unselect Texture Copy otherwise it'll always copy textures used on the tree to the export directory. Select a valid file type for the atlas file types (usually .tga). You can then select Session-&gt;Compile Now.
<p />
<p />
<h2><a name="LODs"></a> LODs </h2>
<p />
Speedtree 5.0 has two or more LOD's of geometry and then a final LOD which is just a billboard. The high detail geometry LOD morphs into the low detail geometry LOD based on distance and the parameters you setup on the SpeedtreeActor in the editor. Then the billboard screendoor fades in, and the low detail geometry LOD fades out.
<p />
<h3><a name="LOD setup in the Modeler"></a> LOD setup in the Modeler </h3>
<p />
Under 'Object Properties - Tree', check 'Enabled' under the 'Level of Detail' category. Change the 'Count' to the value you need. Switch 'Preview style' to 'Use near and far', and either use mouse wheel or click left and middle mouse buttons and drag to zoom in and out. You can change the LOD distances under this category to preview geometry LOD transitions, but keep in mind that you can't view billboard transitions, and the distances you set here will not be used in UE3.
<p />
<h3><a name="LOD setup in the Compiler"></a> LOD setup in the Compiler </h3>
<p />
Before you open your tree in the compiler make sure there are no errors when loading it in the modeler. The compiler will not tell you if there are any errors, but they will mess up your export in difficult to detect ways. For example if your leaf meshes are missing when you compile, billboards will be exported off-center and partly clipped.  It will notify you in the Output window that a mesh failed to load.
<p />
When you create a new session and select your tree, use these settings on the 'Compilation Settings' dialog:
<p />
<img alt="CompilationSettings.jpg" src="rsrc/Three/SpeedTree/CompilationSettings.jpg" />
<p />
Click Finish (not Finish and Compile).
<p />
Change Compilation Image types to output tga's so they can be imported into the editor.
<p />
Change Billboard border to be larger if you get flickering hairline artifacts around billboards in the editor when you are far away like you can see in the top left of this screenshot:
<p />
<img alt="BillboardAtlasArtifact.jpg" src="rsrc/Three/SpeedTree/BillboardAtlasArtifact.jpg" />
<p />
Finally click Start Compilation and keep track of where you told the compiler to output files for the next step.
<p />
<h3><a name="LOD setup in UE3"></a> LOD setup in UE3 </h3>
<p />
Import the .SRT file from the compiler.  Next, import BillboardAtlas_Diffuse.tga and when you get to the Import dialog, check 'Dither Mip-maps alpha'.  This will create noise in the alpha channel which will be used to screendoor fade the billboards, and do the same thing for TextureAtlas_Diffuse.tga.  If you want the branches to dither fade, do the same thing when importing the branches texture.  For bushes where the branches aren't noticeable from a distance you can skip the dithering and use an opaque material which will be more efficient.  Remember to pick TC_Normalmap for compression when you import BillboardAtlas_Normal.
<p />
Create a material for the leaves.  Here's a minimal setup for dither fading during LOD to work:
<p />
<img alt="BranchMaterial.jpg" src="rsrc/Three/SpeedTree/BranchMaterial.jpg" />
<p />
The speedtree runtime will pass an LOD value into the vertex color alpha to make this work.  Setup the billboard material in the same way. Open the USpeedtree asset that you imported and assign these new materials to it.
<p />
Place a SpeedTreeActor in a level and set Lod Level Override to -1. Use the various LOD distances (Lod 3DStart, etc) to control how the LOD's transition.
<p />
Another method to use is to utilize Speedtrees scaling and pruning of leaves and branches.  This can be more visually appealing and requires less material work.  These options are set in the Speedtree modeler.
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
