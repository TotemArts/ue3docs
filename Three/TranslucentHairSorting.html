<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | TranslucentHairSorting    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">TranslucentHairSorting  </b></div>
<div id="tooltext">
<a href="TranslucentHairSortingJP.html" class="twikiLink">日本語訳</a><br><a href="TranslucentHairSortingCH.html" class="twikiLink">中国翻译</a><br><a href="TranslucentHairSortingKR.html" class="twikiLink">한국어</a><br>

<!-- Three/TranslucentHairSorting -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="SkeletalMeshHome.html" class="twikiLink">Skeletal Meshes</a></b> &gt; Translucent Hair Sorting <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="CharacterArtistHome.html" class="twikiLink">Character Artist</a></b> &gt; Translucent Hair Sorting
</div>
<hr size="1" noshade="noshade">
<h1><a name="Translucent Hair Sorting"></a> Translucent Hair Sorting </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="TranslucentHairSorting.html#Translucent Hair Sorting"> Translucent Hair Sorting</a> <ul>
<li> <a href="TranslucentHairSorting.html#Overview"> Overview</a>
</li> <li> <a href="TranslucentHairSorting.html#How to access translucent hair sorting?"> How to access translucent hair sorting?</a>
</li> <li> <a href="TranslucentHairSorting.html#Triangle sorting modes"> Triangle sorting modes</a> <ul>
<li> <a href="TranslucentHairSorting.html#TRISORT_None"> TRISORT_None</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_CenterRadialDistance"> TRISORT_CenterRadialDistance</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_Random"> TRISORT_Random</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_Tootle"> TRISORT_Tootle</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_MergeContiguous"> TRISORT_MergeContiguous</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_Custom"> TRISORT_Custom</a>
</li> <li> <a href="TranslucentHairSorting.html#TRISORT_CustomLeftRight"> TRISORT_CustomLeftRight</a>
</li></ul>
</li> <li> <a href="TranslucentHairSorting.html#Triangle draw order visualization slider"> Triangle draw order visualization slider</a>
</li> <li> <a href="TranslucentHairSorting.html#Notes about reimporting skeletal meshes"> Notes about reimporting skeletal meshes</a>
</li> <li> <a href="TranslucentHairSorting.html#One pass lighting for hair"> One pass lighting for hair</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
It is still too expensive to render each strand of hair in real time games, thus hair is often achieved by layering polygons on top of each other to create the illusion of hair. The polygons are then textured with hair strands with translucent edges. The potential problem with this method, is that the polygons tend to intersect with each other; which is requirement to make hair look less like a helmet on the character's head. As polygons intersect, many real time renderers do not correctly draw the polygons in the correct order producing a shimmering effect or polygon popping effect. Unreal Engine 3 solves this by allowing artists to control the exact rendering order of polygons within skeletal meshes.
<p />
Hair can also be substituted for other hair like instances such as fur or moss.
<p />
<h2><a name="How to access translucent hair sorting?"></a> How to access translucent hair sorting? </h2>
<hr size="1" noshade="noshade">
The hair sorting features can be accessed via the <a href="AnimSetEditorUserGuide.html" class="twikiLink">AnimSet Editor</a>. There you can work with the area designated to be translucent hair, including sorting modes.
<p />
<h2><a name="Triangle sorting modes"></a> Triangle sorting modes </h2>
<hr size="1" noshade="noshade">
<p />
<h3><a name="TRISORT_None"></a> TRISORT_None </h3>
No sorting has been applied to the index buffer, and the triangle drawing order is that which is optimized for the vertex cache.
<p />
<h3><a name="TRISORT_CenterRadialDistance"></a> TRISORT_CenterRadialDistance </h3>
The center of all vertices for this material/section is found. Then each continuous strip of triangles sharing an edge is considered. Strips closer to the center of the mesh are rendered first, followed by strips outside. This usually gives a reasonable result for a player's head because it renders the lower layers first.
<p />
<h3><a name="TRISORT_Random"></a> TRISORT_Random </h3>
This mode is used for testing and just orders the triangles randomly.
<p />
<h3><a name="TRISORT_Tootle"></a> TRISORT_Tootle </h3>
This mode uses AMD's overdraw-minimizing Tootle library to perform a sort similar to TRISORT_CenterRadialDistance.
<p />
<h3><a name="TRISORT_MergeContiguous"></a> TRISORT_MergeContiguous </h3>
This mode retains the existing draw order as much as possible, but if any strips of triangles are physically connected (ie they share an edge) but are not contiguous in the index buffer (drawing order), they will be merged to form a contiguous triangle strip. This is useful for the case where the default draw order after mesh import is quite good, but there are a few non-contiguous strips. Once the strips have been made contiguous, TRISORT_Custom can be used to make adjustments to the strips' drawing sequence.
<p />
<h3><a name="TRISORT_Custom"></a> TRISORT_Custom </h3>
This option allows you to select an individual strip of triangles and change the sort order so it will always render before or after another strip of hair.
<p />
Usually it's best to set the hair to sort with TRISORT_CenterRadialDistance (1) to get a reasonable draw order. But often there will be specific strips of hair for which need to be changed to render in front of or behind other strips. In the example below, we would like the circled strip of hair (2) to render behind the hair strips beside it.
<p />
<img src="rsrc/Three/TranslucentHairSorting/HairSort1.jpg" width='800' height='595' />
<p />
To do this, we change to TRISORT_Custom, and then enable the custom sorting editing mode with the ASV toolbar icon.
<p />
<img src="rsrc/Three/TranslucentHairSorting/HairSort2.jpg" width='800' height='595' />
<p />
Once in the custom sorting mode, you can select a strip of hair by clicking on it. A hair strip is set of triangles in the mesh that are connected to each other by at least one edge.  The selection will draw as a white wireframe over the hair. Once you have a strip of hair selected, you will be able to move it backwards to draw behind other strips, or forwards to draw in front of other strips of hair.
<p />
<img src="rsrc/Three/TranslucentHairSorting/HairSort3.jpg" width='506' height='233' />
<p />
To move it backwards, hold down B and then move the mouse over another strip of hair. The strip under the cursor will render blue of it is currently behind the selected strip. Still holding down B, click with the left mouse and the white selected strip will change its draw order so it is rendered behind the blue strip.
<p />
To move it forwards, hold down F and move the mouse over a strip of hair. This time only strips currently in front of the selected strip will highlight in blue. Click the blue strip and the selected hair will change its draw order so it's rendered in front of the blue strip.
<p />
The yellow text at the bottom of the viewport tells you what to do at each step.
<p />
<img src="rsrc/Three/TranslucentHairSorting/HairSort4.jpg" width='522' height='305' />
<p />
Finally, the hair strip is rendered in the order we want:
<p />
<img src="rsrc/Three/TranslucentHairSorting/HairSort5.jpg" width='584' height='224' />
<p />
<h3><a name="TRISORT_CustomLeftRight"></a> TRISORT_CustomLeftRight </h3>
This option works exactly the same as TRISORT_Custom, but it stores two different drawing orders: one when viewing the left side of the model, and one when viewing the right side. At runtime, the order chosen will depend on which side of the mesh the viewer is viewing. This option increases memory usage by 6 bytes per triangle in the section.
<p />
There is a button in the toolbar to specify whether to edit the left or the right side drawing order:
<img src="rsrc/Three/AnimSetEditorUserGuide/toolbar_customsortleft.jpg" width='30' height='30' />
<p />
There are also two properties that are used to specify the bone and axis to consider when determining whether to render the left or the right version of the hair.
<p /> <ul>
<li> <strong>CustomLeftRightBoneName</strong> - Name of the bone that will have its origin and axis used to determine which side of the hair is visible. This should usually be the head bone. If set to None, origin and local space of the mesh will be used.
</li> <li> <strong>CustomLeftRightAxis</strong> - Bone axis that points to the Right when the camera is facing the mesh. You can visualize the axis for each bone by turning on the skeleton rendering and optionally the bone names. Each bone has 3 colored lines, the Red line is X, Green is Y and Blue is the Z axis.
</li></ul>
<p />
<h2><a name="Triangle draw order visualization slider"></a> Triangle draw order visualization slider </h2>
<hr size="1" noshade="noshade">
This slider allows you to visualize the triangle drawing order. Sliding the slider to the left progressively reduces the number of translucent triangles shown, and sliding it to the right shows more triangles, in the order they are rendered. It also allows you to peel back layers of translucency to select a strip hidden behind other strips.
<p />
<img src="rsrc/Three/AnimSetEditorUserGuide/ProgressiveSlider.jpg" width='100' height='20' />
<p />
It is only effective for materials with a translucent blend mode.
<p />
<h2><a name="Notes about reimporting skeletal meshes"></a> Notes about reimporting skeletal meshes </h2>
<hr size="1" noshade="noshade">
When reimporting a skeletal mesh with custom sorting, Unreal Engine 3 will attempt to backup and restore the sorting order. The vertex order does not need to be the same. Instead, the reference pose position for each triangle in each strip of hair in the new mesh is compared to the old mesh. If all the triangles in the strip match up, the strip will retain the draw order. Strips of hair with modified vertices, or newly added hair strips will however need to be manually sorted. If any strips in the old mesh could not be matched up with the new mesh, a message will warn the user of how many strips could not be matched up.
<p />
<h2><a name="One pass lighting for hair"></a> One pass lighting for hair </h2>
<hr size="1" noshade="noshade">
Lighting translucency in multiple passes does not work correctly with multiple overlapping layers in the same mesh, giving an overly bright result. There is a now one pass lighting setting that is the default for SkeletalMeshCinematicActors, so place a SkeletalMeshCinematicActor to preview the lighting in the editor. The bUseOnePassLightingOnTranslucency flag must be set to true in script on gameplay skeletal mesh components to use the one pass lighting.
<p />
<img src="" width='455' height='420' />
<p />
Click <a href="ContentBlogArchive#One pass lighting for hair">here</a> for more information.
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
