<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | InteractiveFoliageActor    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">InteractiveFoliageActor  </b></div>
<div id="tooltext">
<a href="InteractiveFoliageActorJP.html" class="twikiLink">日本語訳</a><br><a href="InteractiveFoliageActorCH.html" class="twikiLink">中国翻译</a><br><a href="InteractiveFoliageActorKR.html" class="twikiLink">한국어</a><br>

<!-- Three/InteractiveFoliageActor -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="StaticMeshHome.html" class="twikiLink">Static Meshes</a></b> &gt; InteractiveFoliageActor
</div>
<hr size="1" noshade="noshade">
<h1><a name="InteractiveFoliageActor"></a> InteractiveFoliageActor </h1>
<hr size="1" noshade="noshade">
<p />
<em>Document Changelog: Created by <a href="https://udn.epicgames.com/Main/DanielWright" class="restricted" class="restricted" class="twikiLink">Daniel Wright</a>.</em>
<p />
<div class="twikiToc"> <ul>
<li> <a href="InteractiveFoliageActor.html#InteractiveFoliageActor"> InteractiveFoliageActor</a> <ul>
<li> <a href="InteractiveFoliageActor.html#Overview"> Overview</a>
</li> <li> <a href="InteractiveFoliageActor.html#Simple Setup"> Simple Setup</a>
</li> <li> <a href="InteractiveFoliageActor.html#Simple Material Setup"> Simple Material Setup</a>
</li> <li> <a href="InteractiveFoliageActor.html#Advanced Material Setup"> Advanced Material Setup</a>
</li> <li> <a href="InteractiveFoliageActor.html#Spring Physics Settings"> Spring Physics Settings</a>
</li> <li> <a href="InteractiveFoliageActor.html#Limitations"> Limitations</a>
</li> <li> <a href="InteractiveFoliageActor.html#Performance Implications"> Performance Implications</a>
</li> <li> <a href="InteractiveFoliageActor.html#Troubleshooting"> Troubleshooting</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
InteractiveFoliageActor is a new actor type as of QA_APPROVED_BUILD_DEC_2009.  It is effectively a static mesh that receives forces from being pushed or shot and applies these to a spring system, which feeds the results into the <a href="MaterialsCompendium.html#FoliageNormalizedRotationAxisAndAngle" class="twikiAnchorLink">FoliageNormalizedRotationAxisAndAngle</a> node.  This node can be hooked into <a href="WorldPositionOffset.html" class="twikiLink">WorldPositionOffset</a> to animate the mesh with minimal performance impact.
<p />
<h2><a name="Simple Setup"></a> Simple Setup </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p /> <ul>
<li> Select a static mesh in the Content Browser.  Collision is not required on the static mesh.
</li> <li> Right click in an editor viewport and select Add Actor -&gt; Add InteractiveFoliageActor
</li> <li> Apply a material setup to use <a href="MaterialsCompendium.html#FoliageNormalizedRotationAxisAndAngle" class="twikiAnchorLink">FoliageNormalizedRotationAxisAndAngle</a> affecting <a href="WorldPositionOffset.html" class="twikiLink">WorldPositionOffset</a>.
</li></ul>
<p />
<h2><a name="Simple Material Setup"></a> Simple Material Setup </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
All you need to get up and running is a <a href="MaterialsCompendium.html#FoliageNormalizedRotationAxisAndAngle" class="twikiAnchorLink">FoliageNormalizedRotationAxisAndAngle</a> affecting <a href="WorldPositionOffset.html" class="twikiLink">WorldPositionOffset</a>, as seen below.  Use the RotationAboutAxis node to rotate the object about this axis.
<p />
<img alt="SimpleSetup.jpg" src="rsrc/Three/InteractiveFoliageActor/SimpleSetup.jpg" /><br><br>
<p />
The subtract from Object World Position is to move the point that gets rotated down in world space.  With this setup you can now push a bush out of the way, and it will spring back into place once you stop applying forces to it.
<p />
<img alt="NotPushingCropped.jpg" src="rsrc/Three/InteractiveFoliageActor/NotPushingCropped.jpg" />
<img alt="PushingCropped.jpg" src="rsrc/Three/InteractiveFoliageActor/PushingCropped.jpg" /><br><br>
<p />
Of course screenshots don't relay animation very well, so these videos show the result better.<br>
<a href="rsrc/Three/InteractiveFoliageActor/WalkingThroughFields.mp4" target="_top">WalkingThroughFields.mp4</a><br>
<a href="rsrc/Three/InteractiveFoliageActor/Explosions.mp4" target="_top">Explosions.mp4</a><br>
<p />
<h2><a name="Advanced Material Setup"></a> Advanced Material Setup </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
You can modify the Angle that gets fed into RotateAboutAxis to make the rotation affect parts of the mesh differently.  For example you could store a weight in vertex color that controls stiffness, and use this to attenuate the angle.  There's also a <a href="MaterialsCompendium.html#FoliageImpulseDirection" class="twikiAnchorLink">FoliageImpulseDirection</a> node which provides the raw spring offset as a vector from the spring center to the simulated spring position.  This can be useful if you don't want to do the animation with a rotation.<br><br>
<p />
As an example here is a material which uses an offset from vertex color to change the rotation axis for different parts of the mesh.
<p />
<img alt="AdvancedSetup.jpg" src="rsrc/Three/InteractiveFoliageActor/AdvancedSetup.jpg" /><br><br>
<p />
The Custom node in the material above is:
<p />
<img alt="AdvancedSetup2.jpg" src="rsrc/Three/InteractiveFoliageActor/AdvancedSetup2.jpg" /><br><br>
<p />
Here's a video of the material in action.  Note how different parts of the mesh rotate in different directions when you touch it.  This is useful for foliage types where you just want them to move around ambiguously when you touch them and not in a specific direction.
<p />
<a href="rsrc/Three/InteractiveFoliageActor/AdvancedAnimation.mp4" target="_top">AdvancedAnimation.mp4</a><br><br>
<p />
Be sure to use this in conjunction with some ambient wind animation for best results.  The <a href="MaterialsCompendium.html#WindDirectionAndSpeed" class="twikiAnchorLink">WindDirectionAndSpeed</a> node is useful for coordinating wind animation between objects.
<p />
<h2><a name="Spring Physics Settings"></a> Spring Physics Settings </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Each InteractiveFoliageActor has settings which let you control how the spring behaves.  For example, if the spring is not moving enough when your character touches it, increase FoliageTouchImpulseScale.
<p />
<img alt="SpringSettings.jpg" src="rsrc/Three/InteractiveFoliageActor/SpringSettings.jpg" /><br>
<p /> <ul>
<li> <strong>FoliageDamageImpulseScale</strong> - Scales forces applied from damage events.
</li> <li> <strong>FoliageDamping</strong> - Determines the amount of energy lost by the spring as it oscillates.  This force is similar to air friction.
</li> <li> <strong>FoliageStiffness</strong> - Determines how strong the force that pushes toward the spring's center will be.
</li> <li> <strong>FoliageStiffnessQuadratic</strong> - Same as FoliageStiffness, but the strength of this force increases with the square of the distance to the spring's center.  This force is used to prevent the spring from extending past a certain point due to touch and damage forces.
</li> <li> <strong>FoliageTouchImpulseScale</strong> - Scales forces applied from touch events.
</li> <li> <strong>MaxDamageImpulse</strong> - Clamps the magnitude of each damage force applied.
</li> <li> <strong>MaxForce</strong> - Clamps the magnitude of combined forces applied each update.
</li> <li> <strong>MaxTouchImpulse</strong> - Clamps the magnitude of each touch force applied.
</li></ul>
<p />
There's no way to preview the spring's behavior in the editor so the best way to iterate is to create a small test level, and go into PIE to test interactions with the InteractiveFoliageActor.
<p />
<h2><a name="Limitations"></a> Limitations </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p /> <ul>
<li> Currently InteractiveFoliageActor's block projectile weapons, since those do not yet respect PassThroughDamage.
</li> <li> Since <a href="WorldPositionOffset.html" class="twikiLink">WorldPositionOffset</a> is used for animation, all the limitations of that apply.  InteractiveFoliageActor's provide a visual-only effect.
</li></ul>
<p />
<h2><a name="Performance Implications"></a> Performance Implications </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
InteractiveFoliageActor's have very little performance overhead.  They are effectively static meshes with precomputed lighting, and a static mesh is the fastest type of mesh to render.  The only significant difference is that InteractiveFoliageActor's have a collision cylinder which is in the collision octree to receive Touch and TakeDamage events.  InteractiveFoliageActor's are designed to be used everywhere that you would have placed a static mesh for foliage before.
<p />
<h2><a name="Troubleshooting"></a> Troubleshooting </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Use 'show collision' in game or PIE to view the InteractiveFoliageActor's collision cylinder that is used for calculating the forces that are applied to the actor.<br><br>
<p />
You can simplify the material to plugging in <a href="MaterialsCompendium.html#FoliageImpulseDirection" class="twikiAnchorLink">FoliageImpulseDirection</a> into Emissive to debug whether the direction is changing when you touch it.<br><br>
<p />
If your actors are not being affected by explosions, make sure their actor Location is above the ground.  Explosions do line checks to each actor's Location before applying damage.  You can see where the actor's Location is by where the movement widgets are drawn when selecting it in the editor.  You can move the Location higher on the mesh by applying a PrePivot to the actor (under the Display category) and then translate the mesh back to compensate.
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
