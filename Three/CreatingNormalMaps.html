<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | CreatingNormalMaps    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">CreatingNormalMaps  </b></div>
<div id="tooltext">
<a href="CreatingNormalMapsJP.html" class="twikiLink">日本語訳</a><br><a href="CreatingNormalMapsCH.html" class="twikiLink">中国翻译</a><br><a href="CreatingNormalMapsKR.html" class="twikiLink">한국어</a><br>

<!-- Three/CreatingNormalMaps -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="MaterialsAndTexturesHome.html" class="twikiLink">Materials &amp; Textures</a></b> &gt; Techniques for Creating Normal Maps <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="TextureArtistHome.html" class="twikiLink">Texture Artist</a></b> / <b><a href="CharacterArtistHome.html" class="twikiLink">Character Artist</a></b> / <b><a href="EnvironmentArtistHome.html" class="twikiLink">Environment Artist</a></b> &gt; Techniques for Creating Normal Maps
</div>
<hr size="1" noshade="noshade">
<h1><a name="Techniques for Creating Normal Maps"></a> Techniques for Creating Normal Maps </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="CreatingNormalMaps.html#Techniques for Creating Normal Maps"> Techniques for Creating Normal Maps</a> <ul>
<li> <a href="CreatingNormalMaps.html#Overview"> Overview</a>
</li> <li> <a href="CreatingNormalMaps.html#Normal Map Formats"> Normal Map Formats</a>
</li> <li> <a href="CreatingNormalMaps.html#Advice from Epic Artists"> Advice from Epic Artists</a>
</li> <li> <a href="CreatingNormalMaps.html#Downloadable Resources"> Downloadable Resources</a> <ul>
<li> <a href="CreatingNormalMaps.html#nVidia Normal Mapping Plugin"> nVidia Normal Mapping Plugin</a>
</li> <li> <a href="CreatingNormalMaps.html#16 bit filter for the nVidia Plugin"> 16 bit filter for the nVidia Plugin</a>
</li></ul>
</li></ul>
</li></ul>
</div>
<p />
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
This document contains advice from the Epic artists on creating normal maps, as well as links to useful normal map resources.
<p />
<h2><a name="Normal Map Formats"></a> Normal Map Formats </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
<a href="NormalMapFormats.html" class="twikiLink">This document</a> describes the various normal map formats supported by the Unreal Engine.
<p />
Unreal Engine uses normal maps where the green channel is facing down.
<p />
<p />
<h2><a name="Advice from Epic Artists"></a> Advice from Epic Artists </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
When asked how some of the normal maps in Embry Square were created, Epic lead artist <a href="https://udn.epicgames.com/Main/ChrisPerna" class="restricted" class="restricted" class="twikiLink">Chris Perna</a> answers:
<p />
<table>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
<td>
<em>I created those textures from photosource using Nvidia's normal map filter.  The filter is a plug-in for photoshop and can be downloaded from nvidias website.</em>
<p />
<em>The process used varies slightly, but for the most part, I dump down the saturation (in hue/saturation) to greyscale and run a highpass filter on it in photoshop.</em>
<p />
<em>This neutralizes the image a bit, and evens out the tones out somewhat.  Play with the settings to see what works best.</em>
<p />
<em>After I've got that to where I want it, I convert it to 16 bit.  This will create a cleaner normal map than just running the nvidia filter on an 8 bit image.</em>
<p />
<em>Then just run the nvidia normal map filter on the image.  If it is too noisy undo and use a Gaussian blur on it to soften it a bit then run the nvidia filter again.</em>
<p />
<em>I usually set the nvidia filter from 20-60 and get a nice deep normal map.  All of our detail bump-maps are done this way.</em>
<p />
<em>Then you can just overlay them, or use hard light on top of your processed normal map and adjust the opacity of the layer in photoshop to get the desired effect.</em>
<p />
</td>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
</table>
<p />
From Epic technical artist <a href="https://udn.epicgames.com/Main/ShaneCaudle" class="restricted" class="restricted" class="twikiLink">Shane Caudle</a>:
<p />
<table>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
<td>
<em>We do a lot of the surface detail bump maps in Photoshop, using the Nvidia normal mapping plugin, it just takes a grayscale image and converts it into normal map. You can just overlay this over you original normal map in Photoshop to do the surface detail. It's also real easy to adjust the power of the surface bumps just by adjusting the opacity of this layer.</em>
<p />
</td>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
</table>
<p />
From modeler <a href="https://udn.epicgames.com/Main/KevinLanning" class="restricted" class="restricted" class="twikiLink">Kevin Lanning</a>:
<p />
<table>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
<td>
<p />
<strong>On using Max to generate normal maps...</strong>
<p />
<em>Often it can also be the cage itself that does not lend itself to a proper process. Specifically, if you are optimizing your hi poly and low poly elements by removing all the areas of the lowpoly that are mirrored on the UV's, like if there was a rectangle and the long sides were mirrored, you had deleted the additional side so you have an open face. Sometimes this or comparable setup's to this can cause the cage to be skewed and changing the size of it will only cause it to become more skewed.</em>
<p />
<em>I often rely on not using the cage so that max's way of grabbing information is based more on firing off in a number of directions based on the normals of each of the lowpoly faces which is more similar to what is done in SHtools or more recent versions of 3D Studio Max.</em>
<p />
<em>It's good to do your test process's without any Supersampler options enabled and at a smaller size until you have ironed out as many of the kinks in your setup's grab distance (offset max/min height) as possible, as these can be done more speedily.</em>
<p />
<p />
<strong>On correcting problems with normal maps in Photoshop...</strong>
<p />
<em>Once you have found what you can and can't fix you can set the colour of your missed parts to be the base normal map colour (127,127,255) so it doesn't show up as an annoying un antialiased blob of colour and then you can just massage it out by hand in photoshop if there is no 2d workaround.</em>
<p />
<p />
<strong>On errors that occur when rendering normal maps in Max...</strong>
<p />
<em>The target slot message is unimportant, it exists only because max expects that you are doing a normal map process in order to create a max material and so is confused that you are not assigning the outputted images to form a max material.</em>
<p />
<em>System exception during render means you screwed something small and annoying up in your hi poly objects that shouldn't really be an issue if not for the fact that max is REALLY REALLY picky!!!</em>
<p />
<em>You're going to need to trawl through all your hi poly assets to narrow down where the error lies. Below are some of the common errors that cause this:</em>
<p /> <ul>
<li> <em>An empty layer/named selection or object;</em>
</li> <li> <em>A 3d part that has undergone too many operations and now needs its Xform reset;</em>
</li> <li> <em>An Edit poly model that has some weird voodoo thing happening that can only be cured by converting to edit mesh and then back to edit poly;</em>
</li> <li> <em>Or more voodoo that can only be cured by exporting the selected model section out as an obj and then reimporting it back into the scene.</em>
</li></ul>
<p />
<em>The best way to track down these things is to incrementally check each part and add it to the process list of your low poly and try processing again. Sometimes it will crash the moment you add it to the list, so save often but this is the easiest way to track them down.</em>
<p />
<em>Sometimes it is simply because you have too many polys or lights or materials in the scene and need to split the scene into multiple scenes for separate process and reassembling later on.</em>
<p />
</td>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
</table>
<p />
Tips on using other programs to generate normal maps:
<table>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
<td>
<em>Using Maya's Surface Sampler, the green channel in normal maps is inverted.  Inverting it again in Photoshop will fix this problem..  Its also possible to fix this issue by modifying the Unpack Min/Max for that channel in the editor.</em>
<p />
<em>Instead using Nvidias Normalmaptool you could use Crazybump <a href="http://www.crazybump.com/" target="_top">http://www.crazybump.com/</a> which generates way better normalmaps and also diffuse, specular and displacement maps from simple photosource.</em>
<p />
</td>
<td>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</td>
</table>
<p />
<p />
<h2><a name="Downloadable Resources"></a> Downloadable Resources </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
<h3><a name="nVidia Normal Mapping Plugin"></a> nVidia Normal Mapping Plugin </h3>
<p />
The nVidia normal mapping plugin can be downloaded from <a href="http://developer.nvidia.com/object/nv_texture_tools.html" target="_top">http://developer.nvidia.com/object/nv_texture_tools.html</a>.
<p />
Epic artists also use Crazybump for creating normal maps from  heightmaps as well as combining multiple normal maps together. <a href="http://www.crazybump.com/" target="_top">http://www.crazybump.com/</a>
<p />
<p />
<h3><a name="16 bit filter for the nVidia Plugin"></a> 16 bit filter for the nVidia Plugin </h3>
<p />
A 16 bit replacement filter for the normal map plugin can be downloaded below; it is paticularly handy for grayscale images exported from ZBrush.  This new filter has the same filename as the one that comes with the plugin; just go ahead and replace it.
<p /> <ul>
<li> <a href="rsrc/Three/CreatingNormalMaps/NormalMapFilter16.zip" target="_top">NormalMapFilter16.zip</a>: 16 bit normal map filter for the Nvidia plugin
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
