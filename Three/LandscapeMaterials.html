<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | LandscapeMaterials    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">LandscapeMaterials  </b></div>
<div id="tooltext">
<a href="LandscapeMaterialsJP.html" class="twikiLink">日本語訳</a><br><a href="LandscapeMaterialsCH.html" class="twikiLink">中国翻译</a><br><a href="LandscapeMaterialsKR.html" class="twikiLink">한국어</a><br>

<!-- Three/LandscapeMaterials -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="Landscape.html" class="twikiLink">Landscape</a></b> &gt; Landscape Materials
</div>
<hr size="1" noshade="noshade">
<h1><a name="Landscape Materials"></a> Landscape Materials </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="LandscapeMaterials.html#Landscape Materials"> Landscape Materials</a> <ul>
<li> <a href="LandscapeMaterials.html#Overview"> Overview</a>
</li> <li> <a href="LandscapeMaterials.html#Landscape Material Creation"> Landscape Material Creation</a>
</li> <li> <a href="LandscapeMaterials.html#Layer Blending"> Layer Blending</a> <ul>
<li> <a href="LandscapeMaterials.html#Layer Weights and Ordering"> Layer Weights and Ordering</a>
</li></ul>
</li> <li> <a href="LandscapeMaterials.html#Landscape Material Expressions"> Landscape Material Expressions</a> <ul>
<li> <a href="LandscapeMaterials.html#Terrain Layer Weight"> Terrain Layer Weight</a>
</li> <li> <a href="LandscapeMaterials.html#Terrain Layer Coords"> Terrain Layer Coords</a>
</li> <li> <a href="LandscapeMaterials.html#Terrain Layer Switch"> Terrain Layer Switch</a>
</li> <li> <a href="LandscapeMaterials.html#Landscape Layer Blend"> Landscape Layer Blend</a> <ul>
<li> <a href="LandscapeMaterials.html#Note about multiple LB_HeightBlend layers"> Note about multiple LB_HeightBlend layers</a>
</li></ul>
</li></ul>
</li> <li> <a href="LandscapeMaterials.html#Geometry Normal Map"> Geometry Normal Map</a>
</li> <li> <a href="LandscapeMaterials.html#Tessellation and Displacement"> Tessellation and Displacement</a>
</li> <li> <a href="LandscapeMaterials.html#Assigning Materials to Landscapes"> Assigning Materials to Landscapes</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
While any Unreal material can be assigned to a Landscape terrain, the Material system in Unreal Engine 3 does provide some Landscape-specific expressions that allow for blending multiple material networks based on the weighting of the layers of the Landcsape and controlling the UV coordinates mapping those networks to the Landscape. In addition, the full resolution normal map of the Landscape is available. These features make it advantageous to create materials specifically for the Landscapes used in your levels.
<p />
<h2><a name="Landscape Material Creation"></a> Landscape Material Creation </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
<h2><a name="Layer Blending"></a> Layer Blending </h2>
<p />
The ability to blend layers is the basis for texturing Landscape terrains. This is similar to the way terrain systems have worked in Unreal in the past. However, the material side of the Landscape system is implemented differently.
<p />
To setup the ability to blend layers of the Landscape together, a series of <strong>TerrainLayerWeight</strong> expressions is used. Each of these expressions must specify the name of the associated layer in the Landscape terrain in the <strong>Parameter Name</strong> property. For the first layer, you can leave the <strong>Base</strong> input blank, but for subsequent layers, connect the output of the first layer into the Base of the second layer, and so on.
<p />
Under the hood, these nodes will behave like a Static Switch Parameter. Each component of the Landscape has its own MaterialInstanceConstant created from the main Landscape material which is applied to just that component. If a particular layer is not used on a particular landscape component, the sub-tree of nodes connected to the layer will be discarded. This reduces overall material complexity allowing the material applied to the Landscape to contain any number of texture samples as long as the number of samples being used on any individual component never exceeds the maximum set forth by the shader model specifications (16 for SM 3.0). This means it is possible to set up a master material which contains every texture or network used anywhere on the Landscape, which can end up being a very complex collection of networks, while still keeping the final materials applied to the components of the Landscape within the parameters allowed by the hardware.
<p />
Below is a simple example material setup for blending the diffuse color for 4 layers of a Landscape.
<p />
<img src="rsrc/Three/LandscapeMaterials/landscape_material_setup.jpg" alt="landscape_material_setup.jpg" width="900" height="545" />
<p />
<strong>Note:</strong> You can preview effect of different weights on the material by changing the <strong>Preview Weight</strong> properties of the <strong>TerrainLayerWeight</strong> nodes. The <strong>TerrainLayerCoords</strong> node is used to specify the tiling, scale etc parameters for the Landscape layer's textures.
<p />
Of course, any network of expressions can be connected to the <strong>Layer</strong> inputs in place of a simple <strong>TextureSample</strong>. This makes it possible to do more complex effects such as transitioning from detail textures to larger macro textures depending on the distance the layer is being viewed from.
<p />
An alternative to this blending method is to use a LandscapeLayerBlend node (see below).
<p />
<h3><a name="Layer Weights and Ordering"></a> Layer Weights and Ordering </h3>
<p />
Landscape uses weight blending rather than alpha blending, so the blend factors for all layers at any location will up to 1.0. This has the advantage that there is no order dependence - you can paint any layer at any time and its weight is increased and the other existing layers are decreased.  A disadvantage is that when fully painting one layer to 100%, the weight value for all other layers will be 0%. This is evident when using the unpaint tool on a layer already at 100%. The tool doesn't know what other layers to replace the layer you are unpainting with.
<p />
<h2><a name="Landscape Material Expressions"></a> Landscape Material Expressions </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
The material system provides a number of expressions specifically designed to be used with the Landscape system.
<p />
<h3><a name="Terrain Layer Weight"></a> Terrain Layer Weight </h3>
<p />
The TerrainLayerWeight expression allows material networks to be blended based on the weight for the associated layer obtained from the Landscape the material is aplied to.
<p />
<img src="rsrc/Three/LandscapeMaterials/Landscape_Material_LayerExp.png" alt="Landscape_Material_LayerExp.png" width="148" height="148" />
<p />
<strong>Properties</strong>
<p /> <ul>
<li> <strong>Parameter Name</strong> - The name of the layer belonging to the Landscape to be associated with this expression. The weight for this layer is used as the alpha value for blending the two input networks.
</li> <li> <strong>Preview Weight</strong> - The weight to use for preview purposes in the Material Editor.
</li></ul>
<p />
<strong>Inputs</strong>
<p /> <ul>
<li> <strong>Base</strong> - The network to blend the associate layer with. This is generally the result of any previous layer blending, but can be empty if this is the first layer.
</li> <li> <strong>Layer</strong> - The network to blend in for the associated layer.
</li></ul>
<p />
<strong>Outputs</strong>
<p /> <ul>
<li> Outputs the result of the blending between the <strong>Base</strong> and <strong>Layer</strong> inputs based on the layer weights of the layers involved.
</li></ul>
<p />
<h3><a name="Terrain Layer Coords"></a> Terrain Layer Coords </h3>
<p />
The TerrainLayerCoords expression generates UV coordinates that can be used to map material networks to Landscape terrains.
<p />
<img src="rsrc/Three/LandscapeMaterials/Landscape_Material_CoordsExp.png" alt="Landscape_Material_CoordsExp.png" width="148" height="153" />
<p />
<strong>Properties</strong>
<p /> <ul>
<li> <strong>Mapping Type</strong> - The <code>ETerrainCoordMappingType</code> that specifies the orientation to use when mapping the material (or network) to the Landscape.
</li> <li> <strong>Mapping Scale</strong> - The uniform scaling to apply to the UV coordinates.
</li> <li> <strong>Mapping Rotation</strong> - The rotation, in degrees, to apply to the UV coordinates.
</li> <li> <strong>Mapping Pan [U/V]</strong> - The offset in the [U/V] direction to apply to the UV coordinates.
</li></ul>
<p />
<strong>Outputs</strong>
<p /> <ul>
<li> Outputs the UV coordinates to map the material to the Landscape based on the given property values.
</li></ul>
<p />
<h3><a name="Terrain Layer Switch"></a> Terrain Layer Switch </h3>
(Available starting from the October 2011 build)
<p />
TerrainLayerSwitch allows you to exclude some material operations when a particular layer is not contributing to a region of the landscape. This allows you to optimize your material by removing calculations that are not necessary when a particular layer's weight is zero.
<p />
<img src="rsrc/Three/LandscapeMaterials/LayerSwitchNode.png" alt="LayerSwitchNode.png" width="227" height="167" />
<p />
<strong>Inputs</strong> <ul>
<li> <strong>LayerUsed</strong> - the result to use when the layer specified in the node's Properties is in use by the current region of the landscape.
</li> <li> <strong>LayerNotUsed</strong> - the result to use when the layer is not used by the current region of the landscape and has a weight of zero.
</li></ul>
<p />
<strong>Outputs</strong> <ul>
<li> Either the <strong>LayerUsed</strong> or <strong>LayerNotUsed</strong> inputs, depending on whether or not the layer contributes to the particular region of the landscape.
</li></ul>
<p />
<h3><a name="Landscape Layer Blend"></a> Landscape Layer Blend </h3>
(Available starting from the October 2011 build)
<p />
As an alternative to manually blending layers together with the TerrainLayerWeight node, The LandscapeLayerBlend node blends multiple layers together using either alpha blending or alpha blending with a height-based offset. The height-based offset allows a layer to blend with other layers based on a heightmap input. In regions where certain layers are not used, the layers are automatically optimized away and do not contribute to the shader.
<p />
<img src="rsrc/Three/LandscapeMaterials/LayerBlendNode.png" alt="LayerBlendNode.png" width="265" height="470" />
<p />
<strong>Inputs</strong> <ul>
<li> Each layer adds an input for the layer to blend together.
</li> <li> LB_HeightBlend blended layers (see below) also have a height input.
</li></ul>
<p />
<strong>Outputs</strong> <ul>
<li> The result of the layers blended together.
</li></ul>
<p />
The properties for this node contain an array for the user to enter information about the layers to blend together.
<p />
<strong>Properties for Each Layer</strong> <ul>
<li> <strong>Layer Name</strong> - This corresponds to the layer name used in the Landscape edit mode window.
</li> <li> <strong>Blend Type</strong> - Either LB_AlphaBlend or LB_HeightBlend. These are described below.
</li> <li> <strong>Preview Weight</strong> - This is used as the weight value for the layer to preview the blending in the material editor.
</li></ul>
<p />
<img src="rsrc/Three/LandscapeMaterials/LB_HeightBlend.png" alt="LB_HeightBlend.png" width="343" height="192" />
<p />
Below is an example of a the properties for a number of layers blended together, corresponding to the node shown above:
<p />
<img src="rsrc/Three/LandscapeMaterials/LayerBlendProperties.png" alt="LayerBlendProperties.png" width="494" height="766" />
<p />
<h4><a name="Note about multiple LB_HeightBlend layers"></a> Note about multiple LB_HeightBlend layers </h4>
<p />
LB_HeightBlend works by modulating the blend factor (weight) for the layer using the specified height value.  Because all the weights must add up to 1.0, the other layers that are also painted will have their weights boosted to compensate. When you have multiple layers painted on an area and they all LB_HeightBlend, it's possible that all the layers painted in a particular area will simultaneously have a 0 height value, so the desired blend factor for each layer becomes 0. Because there is no implicit or explicit ordering, the result will be black spots because no layers will have any contribution. The situation is worse when you're blending a normal map, because it results in a normal value of (0,0,0) which is not valid and will cause math problems with the lighting. The solution to this problem is to use LB_AlphaBlend for one of the layers. In this case there will always be a non-zero blend factor available.
<p />
<img src="rsrc/Three/LandscapeMaterials/HeightBlendProblem.jpg" alt="LB_HeightBlend Problem" width="800" height="238" />
<p />
In the left image, all layers are LB_HeightBlend, causing some areas to be black. On the right, the red "1" layer has been changed to use LB_AlphaBlend, which solves the problem.
<p />
<p />
<h2><a name="Geometry Normal Map"></a> Geometry Normal Map </h2>
<p />
<strong>NOTE: from the May 2011 Build onwards, the geometry normal map is automatically sampled per-pixel and does not require any extra nodes in material to achieve LOD-independent high-resolution lighting. The information below is only necessary if using a build before May 2011. When upgrading to May 2011 or later, be sure to remove the Heightmap sampling nodes from any Landscape materials.</strong>
<p />
By sampling the heightmap texture in the material, you can access the geometry normal information per-pixel. This gives consistent, high resolution lighting even when the Landscape is LOD'd out in the distance.
<p />
<img src="rsrc/Three/LandscapeMaterials/landscape_geometry_normal_comparison.jpg" alt="landscape_geometry_normal_comparison.jpg" width="900" height="308" />
<p />
Landscape assigns the heightmap texture as a parameter named <strong>Heightmap</strong>. The geometry normal map is stored as a world-space normal vector with X and Y components stored in the Blue and Alpha channels of the heightmap texture. We need to use a few material nodes to generate the Z component, correctly bias it and then transform from World to Component space before we can use it as a normal map.
<p />
The nodes to do that are shown below. There is an example of this in the LandscapeLightingMaterial material in the Engine\Content\EditorLandscapeResources.upk package.
<p />
<img src="rsrc/Three/LandscapeMaterials/landscape_geometry_normal_setup.jpg" alt="landscape_geometry_normal_setup.jpg" width="900" height="345" />
<p />
You can use a similar layer blending structure to the one shown previously connected to the Normal input setup to blend normal maps for multiple layers as well as the geometry normal map together.
<p />
<h2><a name="Tessellation and Displacement"></a> Tessellation and Displacement </h2>
<p />
The TessellationFactors and WorldDisplacement channels of the material can be used in conjunction with Landscape terrains to provide additional detail and deformation. These work exactly as they would with any other standard material and the layer blending can be used in conjunction with these just as with the Diffuse, Normal, or any other channel.
<p />
<!-- See the Tessellation and Displacement pages for more info on making use of these features in your materials. -->
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> These features are limited to use with DirectX 11 enabled. As such, they should be used as secondary, polish effects unless you are targeting DirectX 11 hardware specifically.
<p />
<h2><a name="Assigning Materials to Landscapes"></a> Assigning Materials to Landscapes </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Once created, the material must be assigned to the Landscape actor in the map.
<p />
<img src="rsrc/Three/LandscapeMaterials/Landscape_Material_Default.jpg" alt="Landscape_Material_Default.jpg" width="900" height="327" />
<p />
Assigning the material is done directly in the properties for the Landscape actor via the <code>Landscape Material</code> property in the <strong>Landscape</strong> category. Simply select the material in the Content Browser and then press the <img alt="use_selected_button.png" src="rsrc/Three/LandscapeMaterials/use_selected_button.png" /> button to assign the material.
<p />
<img src="rsrc/Three/LandscapeMaterials/Landscape_Material_Assigned.jpg" alt="Landscape_Material_Assigned.jpg" width="479" height="87" />
<p />
<img src="rsrc/Three/LandscapeMaterials/Landscape_Material_Viewport.jpg" alt="Landscape_Material_Viewport.jpg" width="900" height="327" />
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
