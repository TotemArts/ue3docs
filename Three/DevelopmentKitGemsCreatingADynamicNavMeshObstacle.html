<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | DevelopmentKitGemsCreatingADynamicNavMeshObstacle    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">DevelopmentKitGemsCreatingADynamicNavMeshObstacle  </b></div>
<div id="tooltext">
<a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacleJP.html" class="twikiLink">日本語訳</a><br><a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacleCH.html" class="twikiLink">中国翻译</a><br><a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacleKR.html" class="twikiLink">한국어</a><br>

<!-- Three/DevelopmentKitGemsCreatingADynamicNavMeshObstacle -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<style type="text/css" media="all">@import "rsrc/UDNCSS_test.css";</style>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<p />
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="DevelopmentKitGems.html" class="twikiLink">Unreal Development Kit Gems</a></b> &gt; Creating a dynamic Navigation Mesh Obstacle <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="AIAndNavigationHome.html" class="twikiLink">AI &amp; Navigation</a></b> &gt; Creating a dynamic Navigation Mesh Obstacle
</div>
<hr size="1" noshade="noshade">
<h1><a name="Creating a dynamic Navigation Mesh Obstacle"></a> Creating a dynamic Navigation Mesh Obstacle </h1>
<hr size="1" noshade="noshade">
<p />
<strong><em>Last tested against UDK June, 2011</em></strong>
<br>
<strong><em>PC and iOS compatible</em></strong>
<p />
<div class="twikiToc"> <ul>
<li> <a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacle.html#Creating a dynamic Navigation Mesh Obstacle"> Creating a dynamic Navigation Mesh Obstacle</a> <ul>
<li> <a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacle.html#Overview"> Overview</a> <ul>
<li> <a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacle.html#Related topics"> Related topics</a>
</li></ul>
</li> <li> <a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacle.html#Dynamic Nav Mesh Obstacle"> Dynamic Nav Mesh Obstacle</a>
</li> <li> <a href="DevelopmentKitGemsCreatingADynamicNavMeshObstacle.html#Using _DynamicNavMeshObstacle"> Using DynamicNavMeshObstacle </a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
Navigation meshes have many beneficial features which make it far superior to the older path node system. One of the best features is that it is really easy to define obstacles in real time.
<p />
The older path node system achieved this by turning off path nodes so that the pathing would not use it, however this often led to much larger path node counts as level designers had to bear this in mind. It was also very cumbersome and error prone to use.
<p />
With navigation meshes, it is as simple as defining a 2D shape as the obstacle and registering it.
<p />
<h3><a name="Related topics"></a> Related topics </h3> <ul>
<li> <a href="UsingNavigationMeshes.html" class="twikiLink">Using navigation meshes</a>
</li> <li> <a href="NavigationMeshReference.html" class="twikiLink">Navigation mesh reference</a>
</li> <li> <a href="NavMeshDynamicObstacleSplitting.html" class="twikiLink">Navigation mesh dynamic obstacle splitting</a>
</li> <li> <a href="NavigationMeshTechnicalGuide.html" class="twikiLink">Navigation mesh technical guide</a>
</li></ul>
<p />
<h2><a name="Dynamic Nav Mesh Obstacle"></a> Dynamic Nav Mesh Obstacle </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
The following script is a helper class which extends the existing NavMeshObstacle class. It helps us create the shapes we want easily, by providing a simple to use interface [SetAsSquare, SetAsRectangle, SetAsCircle] for programmers.
<p />
<div class="codetitlebar">
DynamicNavMeshObstacle.uc
</div>
<div class="codesnippet">
<pre>
class DynamicNavMeshObstacle extends NavMeshObstacle;

// List of possible shapes
enum EShape
{
  EShape&#95;None,
  EShape&#95;Square,
  EShape&#95;Rectangle,
  EShape&#95;Circle
};

// Shape of the nav mesh obstacle
var PrivateWrite EShape ShapeType;
// Used in EShape&#95;Square
var PrivateWrite float Width;
// Used in EShape&#95;Square and EShape&#95;Rectangle
var PrivateWrite float Height;
// Used in EShape&#95;Circle
var PrivateWrite float Radius;
// Used in EShape&#95;Circle
var PrivateWrite int Sides;
// Align the obstacle to the rotation of the actor?
var bool AlignToRotation;

simulated function PostBeginPlay()
{
  // Skip default post begin play function
  Super(Actor).PostBeginPlay();
}

function SetAsSquare(float NewWidth)
{
  if (NewWidth &#62; 0.f)
  {
    ShapeType &#61; EShape&#95;Square;
    Width &#61; NewWidth;
  }
}

function SetAsRectangle(float NewWidth, float NewHeight)
{
  if (NewWidth &#62; 0.f &#38;&#38; NewHeight &#62; 0.f)
  {
    ShapeType &#61; EShape&#95;Rectangle;
    Width &#61; NewWidth;
    Height &#61; NewHeight;
  }
}

function SetAsCircle(float NewRadius, float NewSides)
{
  if (NewRadius &#62; 0.f &#38;&#38; NewSides &#62; 0)
  {
    ShapeType &#61; EShape&#95;Circle;
    Radius &#61; NewRadius;
    Sides &#61; NewSides;
  }
}

event bool GetObstacleBoudingShape(out array&#60;vector&#62; Shape)
{
  local Vector Offset;
  local int i, Angle;
  local Rotator R;

  if (ShapeType &#61;&#61; EShape&#95;Square)
  {
    if (AlignToRotation)
    {
      // Top right corner
      Offset.X &#61; Width;
      Offset.Y &#61; Width;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Bottom right corner
      Offset.X &#61; -Width;
      Offset.Y &#61; Width;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Bottom left corner
      Offset.X &#61; -Width;
      Offset.Y &#61; -Width;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Top left corner
      Offset.X &#61; Width;
      Offset.Y &#61; -Width;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
    }
    else
    {
      // Top right corner
      Offset.X &#61; Width;
      Offset.Y &#61; Width;
      Shape.AddItem(Location + Offset);
      // Bottom right corner
      Offset.X &#61; -Width;
      Offset.Y &#61; Width;
      Shape.AddItem(Location + Offset);
      // Bottom left corner
      Offset.X &#61; -Width;
      Offset.Y &#61; -Width;
      Shape.AddItem(Location + Offset);
      // Top left corner
      Offset.X &#61; Width;
      Offset.Y &#61; -Width;
      Shape.AddItem(Location + Offset);
    }

    return true;
  }
  else if (ShapeType &#61;&#61; EShape&#95;Rectangle)
  {
    if (AlignToRotation)
    {
      // Top right corner
      Offset.X &#61; Width;
      Offset.Y &#61; Height;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Bottom right corner
      Offset.X &#61; -Width;
      Offset.Y &#61; Height;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Bottom left corner
      Offset.X &#61; -Width;
      Offset.Y &#61; -Height;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
      // Top left corner
      Offset.X &#61; Width;
      Offset.Y &#61; -Height;
      Shape.AddItem(Location + (Offset &#62;&#62; Rotation));
    }
    else
    {
      // Top right corner
      Offset.X &#61; Width;
      Offset.Y &#61; Height;
      Shape.AddItem(Location + Offset);
      // Bottom right corner
      Offset.X &#61; -Width;
      Offset.Y &#61; Height;
      Shape.AddItem(Location + Offset);
      // Bottom left corner
      Offset.X &#61; -Width;
      Offset.Y &#61; -Height;
      Shape.AddItem(Location + Offset);
      // Top left corner
      Offset.X &#61; Width;
      Offset.Y &#61; -Height;
      Shape.AddItem(Location + Offset);
    }

    return true;
  }
  else if (ShapeType &#61;&#61; EShape&#95;Circle &#38;&#38; Sides &#62; 0)
  {
    // Get the angle of each &#39;slice&#39; defined by the number of sides
    Angle &#61; 65536 / Sides;
    // If we are aligned to rotation, use the rotation as the starting point
    R &#61; (AlignToRotation) ? Rotation : Rot(0, 0, 0);
    // Set the radius
    Offset.X &#61; Radius;
    Offset.Y &#61; 0.f;
    // For each side...
    for (i &#61; 0; i &#60; Sides; ++i)
    {
      // Add the the left side point
      Shape.AddItem(Location + (Offset &#62;&#62; R));
      // Increment to the next side
      R.Yaw +&#61; Angle;
    }

    return true;
  }

  return false;
}

defaultproperties
{
}
</pre>
</div>
<p />
<h2><a name="Using _DynamicNavMeshObstacle"></a> Using DynamicNavMeshObstacle </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
Using the dynamic navigation mesh obstacle is as simple as spawning it in, setting up what kind of obstacle shape you want and registering it.
<p />
<div class="codetitlebar">
<em>YourClass.uc</em>
</div>
<div class="codesnippet">
<pre>
var DynamicNavMeshObstacle PlacementObstacle;

function PostBeginPlay()
{
  Super.PostBeginPlay();
  PlacementObstacle &#61; Spawn(class&#39;DynamicNavMeshObstacle&#39;);
  PlacementObstacle.SetAsCircle(96, 8);
}
</pre>
</div>
<p />
You can also move the DynamicNavMeshObstacle around to create a movable navigation mesh obstacle.
<p />
<div class="codesnippet">
<pre>
function Tick(float DeltaTime)
{
  Super.Tick(DeltaTime);

  ForEach TraceActors(class&#39;Actor&#39;, HitActor, HitLocation, HitNormal, CachedMouseWorldOrigin + CachedMouseWorldDirection &#42; 65536.f, CachedMouseWorldOrigin,,, class&#39;Actor&#39;.const.TRACEFLAG&#95;Bullet)
  {
    if (HitActor.bWorldGeometry)
    {
      PlacementObstacle.UnRegisterObstacle();
      PlacementObstacle.SetLocation(HitLocation);
      PlacementObstacle.RegisterObstacle();
      break;
    }
  }
}
</pre>
</div>
<p />
<img src="rsrc/Three/DevelopmentKitGemsCreatingADynamicNavMeshObstacle/DynamicNavMeshObstacleScreenShot.jpg" alt="DynamicNavMeshObstacleScreenShot.jpg" width='900' height='672' />
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
