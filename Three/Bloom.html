<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | Bloom    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">Bloom  </b></div>
<div id="tooltext">
<a href="BloomJP.html" class="twikiLink">日本語訳</a><br><a href="BloomCH.html" class="twikiLink">中国翻译</a><br><a href="BloomKR.html" class="twikiLink">한국어</a><br>

<!-- Three/Bloom -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="PostProcessEffectsHome.html" class="twikiLink">Post Process Effects</a></b> &gt; Bloom Post Process Effect <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="CinematicArtistHome.html" class="twikiLink">Cinematic Artist</a></b> &gt; Bloom Post Process Effect
</div>
<hr size="1" noshade="noshade">
<h1><a name="Bloom Post Process Effect"></a> Bloom Post Process Effect </h1>
<hr size="1" noshade="noshade">
<p />
<img src="rsrc/Three/Bloom/Bloom.jpg" alt="Bloom.jpg" width='582' height='195' />
<p />
<div class="twikiToc"> <ul>
<li> <a href="Bloom.html#Bloom Post Process Effect"> Bloom Post Process Effect</a> <ul>
<li> <a href="Bloom.html#Overview"> Overview</a>
</li> <li> <a href="Bloom.html#Bloom properties"> Bloom properties</a>
</li> <li> <a href="Bloom.html#Adjusting the bloom shape"> Adjusting the bloom shape</a>
</li> <li> <a href="Bloom.html#Blurring in lower resolution"> Blurring in lower resolution </a>
</li> <li> <a href="Bloom.html#Tonemapper interaction"> Tonemapper interaction</a>
</li> <li> <a href="Bloom.html#Performance and implementation details"> Performance and implementation details</a>
</li> <li> <a href="Bloom.html#Useful console commands"> Useful console commands</a>
</li> <li> <a href="Bloom.html#Mobile Support"> Mobile Support</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Bloom is a real world light phenomena that greatly can add to the perceived realism of a rendered image at a moderate render performance cost. Bloom can be seen by the naked eye when looking at very bright objects that are on a much darker background. Even brighter objects also cause other effects (streaks, lens flares) but those are not covered by the classic bloom effect. Because our displays (e.g. TV, TFT, ...) usually don't support HDR (high dynamic range) we cannot really render very bright objects. Instead we simulate the effects that happen in the eye (retina subsurface scattering), when light hits the film (film subsurface scattering) or in front of the the camera (milky glass filter). The effect might not always be physically correct but it can help to hint the relative brightness of objects or add realism to the LDR (low dynamic range) image.
<p />
<h2><a name="Bloom properties"></a> Bloom properties </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
The properties to tweak the bloom can be found in the post processing chain in the <strong>UberPostProcessEffect</strong> node.
<p />
<strong>Note:</strong> Bloom properties can be found in other nodes as well (e.g. <strong>DOFAndBloomEffect</strong>) but those nodes should not be used, they only exists for backwards compatibility (might run less optimized code, reduced feature set).
<p />
Most of the properties there can also be found in the <strong>PostProcessVolumes</strong>, <strong>WorldProperties</strong>, <strong>CameraActor</strong> and some UnrealScript accessible structures. Those settings follows the usual override behavior like all other post process effects.
<p />
The following image shows the same content with differently tweaked properties:
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/BloomSamples.png" alt="BloomSamples.png" width='464' height='541' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>left top: Default bloom settings <br>right top: Larger <strong>KernelSize</strong> <br>left bottom: Smaller <strong>Threshold</strong> <br>right bottom: With a blue <strong>Tint</strong> </SMALL> </td></tr>
</table>
<br>
<p />
This is where the properties are exposed in the editor (chain):
<p />
<img src="rsrc/Three/Bloom/EditorBloom.png" alt="EditorBloom.png" width='391' height='348' />
<p />
Note that most levels have override the main settings in the <strong>PostProcessVolumes</strong> or in <strong>WorldPoperties</strong>.
<p />
<h2><a name="Adjusting the bloom shape"></a> Adjusting the bloom shape </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Bloom is often implemented by using a separable Gaussian blur kernel. This allows efficient blurring (linear performance to the kernel radius, although the effect extend gains size in width and height).
Using the Gaussian blur and additively blending the result with the source results is not exactly the effect we want to see. It's good enough for a first approximation (many games shipped with that) but when raising the quality bar the bloom should be more detailed nearby the bright parts and should have a wider falloff. To accomplish that we can optionally add another one or two Gaussians contributions. The radius and weight of the three Gaussian curves can be tweaked in the <strong>UberPostProcessEffect</strong> node. The following image shows how this looks like when applied to game content:
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/NewBloom.jpg" alt="NewBloom.jpg" width='696' height='450' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>left top: Without bloom the brightness of the object is not shown well.<br>right top: A single Gaussian Works well for the left object but not so well for the right one.<br>left bottom: Using two Gaussians works well on both objects.<br>right bottom: Using three Gaussians also adds a subtle nice large scale glow.</SMALL> </td></tr>
</table>
<br>
<p />
The following image shows how a Gaussian distribution curve looks like:
<p />
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/one.png" alt="one.png" width='486' height='204' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>The graph shows a limited width Gaussian distribution curve.</SMALL> </td></tr>
</table>
<br>
<p />
<p />
<p />
Three Gaussian curves with different scale and size can be combined:
<p />
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/three.png" alt="three.png" width='486' height='204' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>red: large Gaussian curve<br>blue: medium Gaussian curve<br>green: small Gaussian curve</SMALL> </td></tr>
</table>
<br>
<p />
<p />
By adding the contributions we get the shape we would like to see:
<p />
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/combined.png" alt="combined.png" width='486' height='204' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>The new shape is sharp in the center and more wide over distance.</SMALL> </td></tr>
</table>
<br>
<p />
<p />
The shape can be tweaked in the editor (see "Shape" section in the editor image above) or by using the console commands (see bottom of the page).
<p />
<h2><a name="Blurring in lower resolution"></a> Blurring in lower resolution </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Bloom can be done in lower resolution without scarifying too much quality. We have good experience with quarter resolution (1/16 the area). The separable Gaussian blur allows large radius but at some point even that becomes too costly. Here we can do the computation in even lower resolution and save render performance.
<p />
For backwards compatibility we currently have a single Gaussian by default (weights: 0/1/0). Once the user specifies some amount of weight for small or large a different system is used. The new system does the medium Gaussian in half the resolution (this means it can result in a speedup but also quality reduction). The small Gaussian however is done in the normal bloom resolution. The large Gaussian is done in half the resolution of the medium one. This allows very large radius at very low cost.
<p />
<h2><a name="Tonemapper interaction"></a> Tonemapper interaction </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Bloom is added to the scene before tone mapping for best quality. This means bright areas that are further brightened up by nearby areas blooming are softly converging to the LDR maximum (Usually this means white but for vibrant colors it can be a different color). If bloom has negative effect to the details in such bright areas the <strong>ScreenBlendThreshold</strong> property should be tweaked.
<p />
<table cellspacing="0" cellpadding="1" class="twikiTable" border="0"><tr><td bgcolor="#eaeaea" class="twikiFirstCol"> <img src="rsrc/Three/Bloom/ScreenBlend.png" alt="ScreenBlend.png" width='464' height='269' /> </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> <SMALL>Notice the small difference in the very bright area.</SMALL> </td></tr>
</table>
<br>
<p />
<p />
<h2><a name="Performance and implementation details"></a> Performance and implementation details </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
As we use the separable Gaussian blur method we have a performance cost almost linear scaling with the radius. The radius also scales with the screen resolution (more exactly view width) and the <strong>KernelSize</strong> is defined in pixels for a 1280 resolution. We limited the kernel size to 64 (Performance reasons and to have less shaders variations). Because of the lower resolution we can do that with only 16 lookups in the pixel shader (radius 64 -&gt; width 128 -&gt; 32 in quarter resolution, 16 bilinear filtered samples). If multiple Gaussians are used the medium one is half the resolution and the large one is quarter resolution. This affects quality and performance. The resulting images are currently combined with extra passes.(can be improved).
<p />
To out experience we see performance improvements over the old/default method (one Gaussian) only with large radius (64+).
<p />
<h2><a name="Useful console commands"></a> Useful console commands </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p /> <dl>
<dt> <code><b>BloomScale</b></code> </dt><dd> To adjust the strength of the bloom
</dd> <dt> <code><b>BloomSize</b></code> </dt><dd> To adjust the size of bloom effect
</dd> <dt> <code><b>BloomType</b></code> </dt><dd> To adjust the method that is used internally
</dd> <dt> <code><b>BloomWeightSmall</b></code> </dt><dd> To adjust the weight of the smaller Gaussian blur (after normalization, not like the UI property)
</dd> <dt> <code><b>BloomWeightLarge</b></code> </dt><dd> To adjust the weight of the larger Gaussian blur (after normalization, not like the UI property)
</dd></dl>
<p />
<h2><a name="Mobile Support"></a> Mobile Support </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
On mobile platforms, bloom only works if enabled in System Settings.  It is a high-end mobile feature, and can be quite expensive, so it should only be enabled with care.  Mobile bloom settings can be set under <strong>DefaultPostProcessSettings</strong>, under the <strong>MobilePostProcess</strong> heading.  Note that you must override at least one of <strong>Bloom_Scale</strong>, <strong>Bloom_Threshold</strong>, or <strong>Bloom_Tint</strong> under <strong>MobilePostProcess</strong> for bloom to actually be enabled.  Also, note that when specifying these values in the <strong>WorldInfo</strong>, they will be used when bloom is enabled, even if the value is not overridden in the Property list.
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
