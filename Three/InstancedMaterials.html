<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | InstancedMaterials    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">InstancedMaterials  </b></div>
<div id="tooltext">
<a href="InstancedMaterialsJP.html" class="twikiLink">日本語訳</a><br><a href="InstancedMaterialsCH.html" class="twikiLink">中国翻译</a><br><a href="InstancedMaterialsKR.html" class="twikiLink">한국어</a><br>

<!-- Three/InstancedMaterials -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="MaterialsAndTexturesHome.html" class="twikiLink">Materials &amp; Textures</a></b> &gt; Instanced Materials
</div>
<hr size="1" noshade="noshade">
<h1><a name="Instanced Materials"></a> Instanced Materials </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="InstancedMaterials.html#Instanced Materials"> Instanced Materials</a> <ul>
<li> <a href="InstancedMaterials.html#Overview"> Overview</a>
</li> <li> <a href="InstancedMaterials.html#Instancing a material in the editor"> Instancing a material in the editor</a>
</li> <li> <a href="InstancedMaterials.html#Parameter Groups"> Parameter Groups</a>
</li> <li> <a href="InstancedMaterials.html#Creating Parameterized Materials"> Creating Parameterized Materials</a>
</li> <li> <a href="InstancedMaterials.html#Scalar Parameters"> Scalar Parameters</a>
</li> <li> <a href="InstancedMaterials.html#Vector Parameters"> Vector Parameters</a>
</li> <li> <a href="InstancedMaterials.html#Texture Parameters"> Texture Parameters</a>
</li> <li> <a href="InstancedMaterials.html#Static Parameters"> Static Parameters</a>
</li> <li> <a href="InstancedMaterials.html#Instancing a material in script"> Instancing a material in script</a>
</li></ul>
</li></ul>
</div>
<p />
<style type="text/css" media="all">@import "rsrc/UDNCSS_test.css";</style>
<p />
<h2><a name="Overview"></a> Overview </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
In Unreal Engine 3, material instancing may be used to change the appearance of a material without incurring an expensive recompilation of the material. General modification of the material cannot be supported without recompilation, so the instances are limited to changing the values of predefined material <strong>parameters</strong>. The parameters are statically defined in the compiled material by a unique name, type and default value.  An instance of a material can dynamically provide new values for these parameters with very little expense.
<p />
To allow applying un-instanced materials to primitives, the abstract base class MaterialInterface is used.  This class is an interface to both the expressions and parameter values of an applied material.  The Material class is a subclass of MaterialInterface which defines the expressions and default parameter values.  The <a href="MaterialInstanceConstant.html" class="twikiLink">Material Instance Constant</a> and <a href="InstancedMaterials_TimeVarying.html" class="twikiLink">Material Instances Time Varying</a> classes are subclasses of MaterialInterface with a parent MaterialInstance.  These types both inherit their expressions and parameter values from their parent, optionally overriding or animating some of the parameter values.
<p />
A <a href="MaterialInstanceConstant.html" class="twikiLink">Material Instance Constant</a> is a material instance that has explicitly defined parameter values while a <a href="InstancedMaterials_TimeVarying.html" class="twikiLink">Material Instances Time Varying</a> is a material instance that can have its parameter values animated over time through the use of <a href="Distributions.html" class="twikiLink">distribution</a> curves.
<p />
Material Instances can then be edited using the Material Instance Editor.  See the <a href="MaterialInstanceEditorUserGuide.html" class="twikiLink">Material Instance Editor User Guide</a> for more information.
<p />
<h2><a name="Instancing a material in the editor"></a> Instancing a material in the editor </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
There are two main methods that can be used to create an instance of a material in the editor.
<p />
Click the <strong>new</strong> button in the <a href="ContentBrowserReference.html" class="twikiLink">Content Browser</a> and set the <strong>Factory</strong> option in the <strong>New</strong> dialog to MaterialInstanceConstant (or MaterialInstanceTimeVarying depending on the type of instance you need).
<p />
<img src="rsrc/Three/InstancedMaterials/create_newdialog.jpg" alt="create_newdialog.jpg" width="510" height="510" />
<p />
Then assign the material to be instanced to the <strong>Parent</strong> property for the new material instance.
<p />
<img src="rsrc/Three/InstancedMaterials/create_parentprop.jpg" alt="create_parentprop.jpg" width="786" height="414" />
<p />
Right-click on the material you wish to instance and choose <strong>Create New Material Instance (Constant)</strong> (or <strong>Create New Material Insatnce (Time Varying)</strong> depending on the type of instance you need).
<p />
<img src="rsrc/Three/InstancedMaterials/create_contextmenu.jpg" alt="create_contextmenu.jpg" width="282" height="483" />
<p />
<a name="ParameterGroups"></a>
<h2><a name="Parameter Groups"></a> Parameter Groups </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Parameter expressions have a <strong>Group</strong> property that allows them to be organized when viewed in the Material Instance Editor. Related parameters can be added to the same group making it easy to quickly find and modify all parameters controlling a specific effect or aspect of the parent material. Parameters not belonging to a group default to, and will be displayed in, the <em>None</em> group.
<p />
<img src="rsrc/Three/InstancedMaterials/groups.jpg" alt="groups.jpg" width="745" height="450" />
<p />
<h2><a name="Creating Parameterized Materials"></a> Creating Parameterized Materials </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
To add a parameter to a material, use one of the parameter expression types in the material editor. There are several parameter types that can be used including ScalarParameter, VectorParameter, various texture parameters, and static parameters.
<p />
Give the parameter a unique name, assign it to a <a href="InstancedMaterials.html#ParameterGroups" class="twikiAnchorLink">group</a>, and give it a default value.
<p />
<img src="rsrc/Three/InstancedMaterials/param_edit.jpg" alt="param_edit.jpg" width="878" height="614" />
<p />
<h2><a name="Scalar Parameters"></a> Scalar Parameters </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
A ScalarParameter is a parameter that contains a single floating-point value. These can be used to drive effects based on single values such as specular power, the alpha of a linear interpolation, opacity, etc.
<p />
See the <a href="MaterialsCompendium.html" class="twikiLink">Materials Compendium</a> for a complete listing and descriptions of all expressions.
<p />
<h2><a name="Vector Parameters"></a> Vector Parameters </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
A VectorParameter is a parameter that contains a 4-channel vector value, or 4 floating-point values. These are generally used to provide configurable colors, but could also be used to represent positional data or drive any effect that requires multiple values.
<p />
See the <a href="MaterialsCompendium.html" class="twikiLink">Materials Compendium</a> for a complete listing and descriptions of all expressions.
<p />
<h2><a name="Texture Parameters"></a> Texture Parameters </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
There are several texture parameters available. Each one is specific to the type of texture that is accepts or the manner in which it is being used. Due to the shader code that is generated being different depending on the texture type, a separate expression is required for each specific texture-type.
<p /> <ul>
<li> TextureSampleParameter2D accepts a basic Texture2D
</li> <li> TextureSampleParameterCube accepts a TextureCube or cubemap.
</li> <li> TextureSampleParameterFlipbook accepts a FlipbookTexture.
</li> <li> TextureSampleParameterMeshSubUV accepts a Texture2D that is used for sub-uv effects with a mesh emitter.
</li> <li> TextureSampleParameterMeshSubUV accepts a Texture2D that is used for sub-uv blending effects with a mesh emitter.
</li> <li> TextureSampleParameterMovie accepts a MovieTexture (bink movie).
</li> <li> TextureSampleParameterNormal a Texture2D that is used as a normal map.
</li> <li> TextureSampleParameterSubUV accepts a Texture2D that is used for sub-uv effects with a sprite emitter.
</li></ul>
<p />
See the <a href="MaterialsCompendium.html" class="twikiLink">Materials Compendium</a> for a complete listing and descriptions of all expressions.
<p />
<h2><a name="Static Parameters"></a> Static Parameters </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
Static parameters are applied at compile-time, so they produce more optimal code as entire branches of the material that are masked out by a static parameter will be compiled out and not executed at runtime.  Because they are applied at compile-time, they can only be changed from within the <a href="MaterialInstanceEditorUserGuide.html" class="twikiLink">MaterialInstanceEditor</a> and not from script.
<p />
<strong>Warning: A new material will be compiled out for every combination of static parameters in the base material that are used by instances!</strong>
<p />
This can lead to an excessive amount of shaders being compiled.  Try to minimize the number of static parameters in the material and the number of permutations of those static parameters that are actually used.  See <a href="MaterialsCompendium.html#Static Switch Parameter" target="_top">Static Switch Parameter</a> and <a href="MaterialsCompendium.html#Static Component Mask Parameter" target="_top">Static Component Mask Parameter</a> for information on the specific static parameter types.
<p />
See the <a href="MaterialsCompendium.html" class="twikiLink">Materials Compendium</a> for a complete listing and descriptions of all expressions.
<p />
<h2><a name="Instancing a material in script"></a> Instancing a material in script </h2>
<div style="margin-top:-10px;"><hr size="1" noshade="noshade"></div>
<p />
To create a script-controlled material instance, use the new keyword in UnrealScript to create a new MaterialInstanceConstant object.  Use the SetParent function to set the material which defines the expressions and default parameter values of the instance, and use the SetScalarParameterValue or SetVectorParameterValue functions to change parameter values for that instance.
<p />
Here's code demonstrating how to create and apply a material instance with UnrealScript controlled parameters:
<p />
<div class="codesnippet">
<pre>
var MeshComponent Mesh;
var MaterialInstanceConstant MatInst;

var float TanPercent;

function InitMaterialInstance()
{
   MatInst &#61; new(None) Class&#39;MaterialInstanceConstant&#39;;
   MatInst.SetParent(Mesh.GetMaterial(0));
   Mesh.SetMaterial(0, MatInst);
   UpdateMaterialInstance();
}

function UpdateMaterialInstance()
{
   MatInst.SetScalarParameterValue(&#39;TanPercent&#39;,TanPercent);
}

function Timer()
{
   if(/&#42;character is outside&#42;/)
      TanPercent &#61; Lerp(/&#42;tanning rate&#42;/,TanPercent,1.0);
   UpdateMaterialInstance();
}
</pre>
</div>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
