<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | AnimationCompressionTechnicalGuide    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">AnimationCompressionTechnicalGuide  </b></div>
<div id="tooltext">
<a href="AnimationCompressionTechnicalGuideJP.html" class="twikiLink">日本語訳</a><br><a href="AnimationCompressionTechnicalGuideCH.html" class="twikiLink">中国翻译</a><br><a href="AnimationCompressionTechnicalGuideKR.html" class="twikiLink">한국어</a><br>

<!-- Three/AnimationCompressionTechnicalGuide -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="AnimationHome.html" class="twikiLink">Animation</a></b> &gt; Animation Compression Technical Guide
</div>
<hr size="1" noshade="noshade">
<h1><a name="Animation Compression Technical Guide"></a> Animation Compression Technical Guide </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="AnimationCompressionTechnicalGuide.html#Animation Compression Technical Guide"> Animation Compression Technical Guide</a> <ul>
<li> <a href="AnimationCompressionTechnicalGuide.html#Overview"> Overview</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Important Terms"> Important Terms</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Compression Data Structure"> Compression Data Structure</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Key Compression Formats"> Key Compression Formats</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Key Reduction Schemes"> Key Reduction Schemes</a> <ul>
<li> <a href="AnimationCompressionTechnicalGuide.html#Adding Key Reduction Schemes"> Adding Key Reduction Schemes</a> <ul>
<li> <a href="AnimationCompressionTechnicalGuide.html#Properties"> Properties</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Functions"> Functions</a>
</li></ul>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Compression during load"> Compression during load</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Compressing in code"> Compressing in code</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Default compression scheme"> Default compression scheme</a>
</li> <li> <a href="AnimationCompressionTechnicalGuide.html#Decompression at runtime"> Decompression at runtime</a>
</li></ul>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
Making use of animation compression <!--  -->is a straightforward process in Unreal Engine 3. This document covers the main classes and data structures involved and provides an overview of how to go about using <!--  -->animation compression.
<p />
For details about the various compression algorithms, please see the <a href="AnimationCompressionAlgorithms.html" class="twikiLink">Animation Compression Algorithms</a> page.
<p />
For information on the editor controls for previewing and modifying animation compression, please see the <a href="AnimationCompressionDialog.html" class="twikiLink">Animation Compression</a> page.
<p />
<h2><a name="Important Terms"></a> Important Terms </h2>
<hr size="1" noshade="noshade">
Below are some important terms used throughout this document that need to be understood:
<p /> <ul>
<li> <strong>Key</strong> - A set of data points defining the position and rotation of an individual bone at a specific time.
</li> <li> <strong>Track</strong> - A set of keys describing the motion an individual bone over time.
</li> <li> <strong>AnimSequence</strong> - A set of Tracks defining the motion of all the bones making up an entire skeleton.
</li> <li> <strong>AnimSet</strong> - A set of related AnimSequences which all play on the same skeleton.
</li></ul>
<p />
<!--  -->
<p />
<a name="KeyCompressionFormats"></a>
<h2><a name="Key Compression Formats"></a> Key Compression Formats </h2>
<hr size="1" noshade="noshade">
What follows is a description of each of the compression formats, represented internally as the enum AnimationCompressionFormat. These enums are assigned to UAnimSequence's TranslationCompressionFormat and RotationCompressionFormat members, and, in conjunction with an AnimSequence::CompressionScheme member, denote what type of compression and key reduction has been applied to the animation sequence.  At full precision, translations are stored as three-vectors (3x32bit floats), while rotations are stored as quaternions (4x32bit floats). Note that the current set of compression algorithms only compress rotation information and do not compress translation.
<p />
Except for ACF_None, the following formats apply only to rotation data only.  For all formats, the w coordinate of the normalized quaternion is derived from the imaginary coordinates, which are stored as follows:
<p /> <ul>
<li> <strong>ACF_None</strong> - Translation/rotation data is stored at full precision (3x32bit for translation, 4x32bit for rotation).
</li> <li> <strong>ACF_Float96NoW</strong> - Imaginary coordinates of rotation keys are stored as 3x32bit floats.
</li> <li> <strong>ACF_Fixed48NoW</strong> - Imaginary coordinates of rotation keys are stored as 3x16bit quantized floats.
</li> <li> <strong>ACF_IntervalFixed32NoW</strong> - Imaginary coordinates of rotation keys are stored quantized to 11 bits for X, 11 bits for y, 10 bits for z, but with the range of quantization remapped to the interval spanned by the coordinate values for that track.
</li> <li> <strong>ACF_Fixed32NoW</strong> - Imaginary coordinates of rotation keys are stored quantized to 11 bits for X, 11 bits for y, 10 bits for z.
</li> <li> <strong>ACF_Float32NoW</strong> - Imaginary coordinates of rotation keys are stored as reduced-precision floats; 7e3 for x, 7e3 for y, 6e3 z.
</li></ul>
<p />
In Gears of War, animations were imported to the engine at 30Hz and key-reduced to 15Hz using the <a href="AnimationCompressionAlgorithms.html#RemoveEverySecondKey" class="twikiAnchorLink">Remove Every Second Key</a> technique. Gears used the ACF_Fixed48NoW compression as an across-the-board solution (where imaginary quaternion components are stored as 16-bit fixed point values). A large number of motions used the ACF_IntervalFixed32NoW format (where imaginary quaternion components are stored at 11-11-10bit fixed point).  Also, a few select motions in cinematic close-ups were stored with the preceptually-lossless ACF_Float96NoW format (imaginary quaternion compnents are stored as 32-bit floating point values).
<p />
In summary: <ul>
<li> <strong>ACF_Float96NoW</strong> - Perceptually loss-less, poor compression
</li> <li> <strong>ACF_Fixed48NoW</strong> - Mid-high quality, decent compression
</li> <li> <strong>ACF_IntervalFixed32NoW</strong> - Mid quality, good compression
</li></ul>
<p />
<h2><a name="Key Reduction Schemes"></a> Key Reduction Schemes </h2>
<hr size="1" noshade="noshade">
Key reduction schemes are the algorithms that are used to eliminate key frames in Unreal Engine 3.  The key reduction schemes transform the raw animation data stored in the RawAnimData member into the separated TranslationData and RotationData streams.  These new streams can contain completely different keys from what exists in the raw data.  Typical schemes might remove unneeded keys, resample existing keys, and so on.  These keys are then compressed according to the requested translation and rotation formats desribed in the <a href="AnimationCompressionTechnicalGuide.html#CompressionFormats" class="twikiAnchorLink">Compression Formats</a> section.
<p />
Currently, the following key reduction schemes are supplied with Unreal Engine 3:
<p /> <ul>
<li> <strong>Bitwise Compress Only</strong> - No key reduction is performed -- in other words, compression comes only from the specified bitwise compression format.
</li> <li> <strong>Remove Trivial Keys</strong> - Reduces tracks where all keys are the same value down to a single key.
</li> <li> <strong>Remove Every Second Key</strong> - Every second key is eliminated.
</li> <li> <strong>Revert To Raw</strong> - Restores the raw animation data by outputing no translation/rotation keys for bitwise compression.
</li></ul>
<p />
<!--  -->
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
