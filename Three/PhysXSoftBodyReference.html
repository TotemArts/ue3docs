<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | PhysXSoftBodyReference    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">PhysXSoftBodyReference  </b></div>
<div id="tooltext">
<a href="PhysXSoftBodyReferenceJP.html" class="twikiLink">日本語訳</a><br><a href="PhysXSoftBodyReferenceCH.html" class="twikiLink">中国翻译</a><br><a href="PhysXSoftBodyReferenceKR.html" class="twikiLink">한국어</a><br>

<!-- Three/PhysXSoftBodyReference -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="PhysicsHome.html" class="twikiLink">Physics</a></b> &gt; PhysX Soft Bodies
</div>
<hr size="1" noshade="noshade">
<p />
<h1><a name="PhysX Soft Bodies"></a> PhysX Soft Bodies </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="PhysXSoftBodyReference.html#PhysX Soft Bodies"> PhysX Soft Bodies</a> <ul>
<li> <a href="PhysXSoftBodyReference.html#Overview"> Overview</a>
</li> <li> <a href="PhysXSoftBodyReference.html#Create the skeletal mesh asset in a 3D content creation package"> Create the skeletal mesh asset in a 3D content creation package</a>
</li> <li> <a href="PhysXSoftBodyReference.html#Import the skeletal mesh into UE3 and set the soft body properties"> Import the skeletal mesh into UE3 and set the soft body properties</a> <ul>
<li> <a href="PhysXSoftBodyReference.html#Tetra mesh Preview"> Tetra mesh Preview</a>
</li> <li> <a href="PhysXSoftBodyReference.html#Attachments"> Attachments</a>
</li></ul>
</li> <li> <a href="PhysXSoftBodyReference.html#Adding the soft body to the level"> Adding the soft body to the level</a> <ul>
<li> <a href="PhysXSoftBodyReference.html#Miscellaneous"> Miscellaneous</a>
</li></ul>
</li> <li> <a href="PhysXSoftBodyReference.html#Downloads"> Downloads</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
Soft bodies in UE3 are available as an optional extension to skeletal meshes, similar to cloth. Their usage in the editor - i.e., how soft body meshes are imported, edited and placed into levels - also closely mirrors the handling of cloth assets. Before reading on, please make sure you’re familiar with at least the basics of how to use cloth, as this tutorial will primarily highlight the soft body specific details and just quickly skim over the basic concepts shared with cloth.
<p />
From a global perspective, there are still some notable differences between the two features:
<p />
<table cellspacing="1" cellpadding="1" class="twikiTable" border="0"><tr><th bgcolor="#dadada" align="center" class="twikiFirstCol"> <a rel="nofollow" href="https://udn.epicgames.com/bin/publish/WebHome?webs=Main%2CTwo%2CThree%2CPowered&amp;amp;inclusions=%2A&amp;amp;exclusions=&amp;amp;filter=&amp;amp;inclfilter=%5C%25META%5C%3AFIELD%5C%7Bname%5C%3D%5C%22Documentavailability%5C%22.%2Avalue%5C%3D%5C%22General%20public%5C%22&amp;amp;filterbymeta=yes&amp;amp;skin=static_udn3&amp;amp;restrictedclass=restricted&amp;amp;format=&amp;amp;sortcol=0;table=1;up=0#sorted_table" class="restricted" title="Sort by this column"><font color="#000000">Cloth</font></a> </th><th bgcolor="#dadada" align="center"> <a rel="nofollow" href="https://udn.epicgames.com/bin/publish/WebHome?webs=Main%2CTwo%2CThree%2CPowered&amp;amp;inclusions=%2A&amp;amp;exclusions=&amp;amp;filter=&amp;amp;inclfilter=%5C%25META%5C%3AFIELD%5C%7Bname%5C%3D%5C%22Documentavailability%5C%22.%2Avalue%5C%3D%5C%22General%20public%5C%22&amp;amp;filterbymeta=yes&amp;amp;skin=static_udn3&amp;amp;restrictedclass=restricted&amp;amp;format=&amp;amp;sortcol=1;table=1;up=0#sorted_table" class="restricted" title="Sort by this column"><font color="#000000">Soft Body</font></a> </th></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> In cloth simulation, the simulated mesh is a triangle mesh whose vertices are always a subset of the skeletal mesh’s graphical representation (namely those attached to cloth bones). </td><td bgcolor="#ffffff"> For soft bodies, the simulated mesh is volumetric and consists of tetrahedra instead of triangles. The graphical mesh of the skeletal mesh is then “skinned” to the simulated tetrahedra, similar to how the graphical mesh can be skinned to rigid bodies. </td></tr>
<tr><td bgcolor="#eaeaea" class="twikiFirstCol"> The resolution of the simulated cloth mesh depends directly on the resolution of the underlying graphical mesh. </td><td bgcolor="#eaeaea"> The resolution of the simulated mesh can be controlled independently of the resolution of the graphical mesh (by choosing proper soft body tetra mesh generation parameters when modifying the skeletal mesh within the <a href="AnimSetEditorUserGuide.html" class="twikiLink">AnimSet Editor</a>). </td></tr>
<tr><td bgcolor="#ffffff" class="twikiFirstCol"> The deformation of cloth has two major behavioral parameters, namely the amount of resistance against motion that:<br/>   - Stretches the cloth.<br/>   - Bends the cloth.<br/> </td><td bgcolor="#ffffff"> The deformation behavior of soft bodies has also has two 'stiffness' parameters against motion that:<br/>   - Stretches the soft body.<br/>   - Changes the volume of the soft body.<br/> </td></tr>
</table>
<p />
Further, cloth has a number of additional features that are not currently supported for soft bodies, for instance: <ul>
<li> Internal tearing of the simulation mesh is not supported.
</li> <li> "Auto Attachment", i.e. automatic attachment of the soft body to colliding physics objects is not supported (attachment via "special bones" is though).
</li> <li> Blending of the results from the soft body simulation with regular skinning is not supported (i.e., there’s no "SoftBodyBlendWeight").
</li></ul>
<p />
<h2><a name="Create the skeletal mesh asset in a 3D content creation package"></a> Create the skeletal mesh asset in a 3D content creation package </h2>
<hr size="1" noshade="noshade">
This first step is identical to the creation of cloths. All that is needed as an input for the Unreal Editor is a skeletal mesh that has one or several “soft body bones” assigned to its vertices. When creating a mesh asset inside a 3D editing tool like Max/Maya, make sure to create at least one bone where the vertices of the mesh that should be affected by the soft body simulation are attached to (with a weight bigger than zero).
<p />
When done with the editing, export the skeletal mesh to a file to be imported into the Unreal Editor.
<p />
(See the cloth documentation in <a href="https://udn.epicgames.com/Three/MasteringUnrealPhysics" class="restricted" class="restricted" class="twikiLink">MasteringUnrealPhysics</a>, section 15.8, for more details.)
<p />
<h2><a name="Import the skeletal mesh into UE3 and set the soft body properties"></a> Import the skeletal mesh into UE3 and set the soft body properties </h2>
<hr size="1" noshade="noshade">
Import the skeletal mesh created with your 3D editing tool inside the <a href="ContentBrowserReference.html" class="twikiLink">Content Browser</a>. Clicking on the thumbnail will open up the <a href="AnimSetEditorUserGuide.html" class="twikiLink">AnimSet Editor</a> where the skeletal mesh will be displayed. Below is an example view of a skeletal mesh (<strong>SoftBodySausage</strong>) that has 3 bones attached (visualized via View -&gt; Show Bone Names).
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/image001.png"/>
<p />
The properties of the soft body can now be manipulated by expanding the <strong>SoftBody</strong> section found under the <strong>Mesh</strong> tab to the left of the preview window:
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/image003.png"/>
<p />
The most important properties of the skeletal mesh are shown above:
<p /> <ul>
<li> <strong>bForceCPUSkinning</strong> - This has to be checked in order for the soft body vertices to be actually simulated.
</li> <li> <strong>SoftBodyBones</strong> - As with the "ClothBones" array in the case of cloths, the bone names that are entered into this array will be used to determine which part of the skeletal mesh will be simulated as a soft body. Here, we’ve entered the names of all 3 bones, so the entire mesh will be used.
</li> <li> <strong>SoftBodyVolume/Stretching Stiffness</strong> <ul>
<li> Setting both to the maximal value 1.0 will result in a very stiff soft body that will try to keep the original shape as close as possible.
</li> <li> Keeping volume stiffness at 1.0 and using a very low value for the stretching stiffness (e.g. 0.0001, zero is not allowed) will give a "liquid blob" behavior, i.e., the soft body will lose its original shape while still attempting to keep the total volume the same.
</li> <li> Setting both values very low will make the soft body lose its original shape almost entirely.
</li></ul>
</li> <li> <strong>SoftBodyParticleRadius</strong> - This is the equivalent to the cloth’s "thickness". It’s the minimum collision distance that the soft body will keep from other physics objects. Raising this can help prevent the soft body tunnel through objects in some cases.
</li> <li> <strong>SoftBodyDetailLevel, SoftBodySubdivisionLevel, bSoftBodyIsoSurface</strong> - These control the resolution of the generated tetra mesh. See below for details.
</li></ul>
<p />
Other parameters are more or less identical in meaning to those of cloth.
<p />
In contrast to cloth meshes, soft body meshes do not directly use the graphical mesh, but need to run a volume mesh generation algorithm based on the graphics skeletal mesh first. This algorithm will generate a set of tetrahedra that approximate the previously 2 dimensional surface mesh with a 3 dimensional shape.
<p />
Before the soft body can be simulated, the user needs to trigger the tetra mesh generation himself by clicking on the first of the two tetrahedron icons (highlighted below) in the editor’s toolbar.
<p />
The resulting approximation will be shown as a wire frame model. (The previewing can be enabled/disabled by clicking on the menu entry "Show Soft Body Tetra" under "View".)
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> When no tetra mesh is shown, make sure you have a valid set of bones added to the "SoftBodyBones" array and <strong>bForceCPUSkinning</strong> enabled.
<p />
<h3><a name="Tetra mesh Preview"></a> Tetra mesh Preview </h3>
Besides previewing the tetra mesh, you can also preview the simulation behavior by clicking on the "Toggle Soft Body Preview Simulation" icon.
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/image005.png"/>
<p />
The tetra mesh generation algorithm has a few parameters that can be tuned to control the resolution/quality of the simulation mesh:
<p /> <ul>
<li> <strong>SoftBodyDetailLevel / SoftBodySubdivisionLevel</strong> - These control the resolution of the soft body mesh. Lowering them will generally result in a simulation mesh that has fewer tetrahedra and vertices and is thus less expensive to simulate.
</li> <li> <strong>bSoftBodyIsoSurface</strong> - If this is enabled, the tetra generator will first compute an "iso surface" around the graphical mesh and use this as an input, instead of directly using the raw mesh data. This can be useful if the original graphics mesh has many degenerated triangles, which can cause the generator to output degenerate simulation meshes as well, leading to simulation artifacts.
</li></ul>
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> that you need to regenerate the tetra mesh if you want changes to these parameters take effect.
<p />
<h3><a name="Attachments"></a> Attachments </h3>
Soft bodies can be attached to a skeletal mesh via <strong>SoftBodySpecialBones</strong> in the same manner than cloth can via "ClothSpecialBones" (see <a href="PhysXClothReference.html" class="twikiLink">PhysXClothReference</a>).
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/Attachment_animset_softbody.jpg"/>
<p />
As a short summary, the following steps are needed:
<p /> <ol>
<li> A simple physics asset must be created for the skeletal mesh. To create such an asset, right click on the soft body’s skeletal mesh in the <a href="ContentBrowserReference.html" class="twikiLink">Content Browser</a> and select "Create New Physics Asset". Select "Minimum Bone Size" to be -1.
</li> <li> Now, PhAT should display the skeletal mesh with some auto generated collision boxes for each bone. If this default is not good enough, one can additionally edit the scale/orientation/blocking behavior for the collision geometry. (see PhATUserGuide)
</li> <li> The attached soft body can now be put into the level. Be sure that the SkeletalMeshActor’s SkeletalMeshComponent has the newly created physics asset referenced in its <strong>PhysicsAsset</strong> property and has <strong>bHasPhysicsAssetInstance</strong> checked as well. Additionally, set physics weight to 1.f under SkeletalMeshComponent.
</li></ol>
<p />
Once placed in a level, the following console command visualizations are useful in determining which vertices from the tetrahedral are attached to the Physics Asset: <strong>nxvis softbody_attachment</strong> and <strong>nxvis softbody_mesh</strong>. Both of these are used below.
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/attached_softbody_verts.jpg"/>
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> <strong>SoftBodySpecialBones</strong> reference the vertices of the graphics mesh, while the actual attached vertices are those of the simulated tetrahedron mesh, so there cannot be a direct correspondence between the two (unlike cloth).  When a vertex of the graphics mesh is a target for attachment, all vertices of its containing tetrahedron are used instead, but only if their distance to the original vertex lies below the SkeletalMesh’s <strong>SoftBodyAttachmentThreshold</strong>. Changing this value therefore affects how far from the 'special bone' tetra vertices will still be attached.
<p />
Furthermore, there is no blending of attachment and simulation. The attachment is binary and the tetrahedral vertices is either fully attached or fully simulated.
<p />
<h2><a name="Adding the soft body to the level"></a> Adding the soft body to the level </h2>
<hr size="1" noshade="noshade">
To put the soft body into a level, select the skeletal mesh in the <a href="ContentBrowserReference.html" class="twikiLink">Content Browser</a> and right click into the level editor to add a skeletal mesh actor into the scene.
<p />
Open a property window for the newly created actor:
<p />
<img src="rsrc/Three/PhysXSoftBodyReference/image007.png"/>
<p />
Under SkeletalMeshActor you’ll now find an additional category <strong>SoftBody</strong>. To run the soft body in the level, enable the simulation check box. To have it collide with level geometry, also select appropriate channels to collide with, e.g. the "default" channel as shown above.
<p />
<h3><a name="Miscellaneous"></a> Miscellaneous </h3> <ul>
<li> There are two new console commands that can be used when the game is running: <ul>
<li> <strong>nxvis softbody_mesh</strong> – Visualizes the tetrahedron mesh associated to the soft body.
</li> <li> <strong>nxvis softbody_attachment</strong> – Shows the points attached to collision geometry or the world.
</li></ul>
</li> <li> The effect of the "stiffness" parameters on the soft body shape unfortunately depends on the magnitude of the simulation time step. Smaller time steps will make the soft body behave stiffer even though the stiffness values have not changed. When using a varying simulation time step, peaks in the actual elapsed simulation time can cause the soft body to start wobbling "out of nowhere".  <br/> As a workaround, one should run soft bodies in a compartment with a fixed time step. (e.g. through the editor via View -&gt; World Properties -&gt; Physics -&gt; PhysicsTimings -&gt; CompartmentTimingSoftBody -&gt; bFixedTimeStep).
</li></ul>
<p />
<h2><a name="Downloads"></a> Downloads </h2>
<hr size="1" noshade="noshade"> <ul>
<li> <a href="rsrc/Three/PhysXSoftBodyReference/SoftBodyExample.zip" target="_top">Download</a> an example of a soft body.
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
