<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | MOBAKitMinimap    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">MOBAKitMinimap  </b></div>
<div id="tooltext">
<a href="MOBAKitMinimapCH.html" class="twikiLink">中国翻译</a><br><a href="https://udn.epicgames.com/Three/MOBAKitMinimapKR" class="restricted" class="restricted" class="twikiLink">한국어</a><br>

<!-- Three/MOBAKitMinimap -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<style type="text/css" media="all">@import "rsrc/UDNCSS_test.css";</style>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="DevelopmentKitGems.html" class="twikiLink">Unreal Development Kit Gems</a></b> &gt; <b><a href="MOBAKit.html" class="twikiLink">MOBA Starter Kit</a></b> &gt; Mini map <br/>
</div>
<hr size="1" noshade="noshade">
<p />
<h1><a name="MOBA Starter Kit - Mini map"></a> MOBA Starter Kit - Mini map </h1>
<hr size="1" noshade="noshade">
<p />
<strong><em>Last tested against UDK May, 2012</em></strong>
<p />
<div class="twikiToc"> <ul>
<li> <a href="MOBAKitMinimap.html#MOBA Starter Kit - Mini map"> MOBA Starter Kit - Mini map</a> <ul>
<li> <a href="MOBAKitMinimap.html#Overview"> Overview</a>
</li> <li> <a href="MOBAKitMinimap.html#Feature Set"> Feature Set</a>
</li> <li> <a href="MOBAKitMinimap.html#Mini Map Icons"> Mini Map Icons</a> <ul>
<li> <a href="MOBAKitMinimap.html#Flash"> Flash</a> <ul>
<li> <a href="MOBAKitMinimap.html#Mini Map Icons"> Mini Map Icons</a>
</li> <li> <a href="MOBAKitMinimap.html#Mini Map Area"> Mini Map Area</a>
</li> <li> <a href="MOBAKitMinimap.html#Mini Map Box"> Mini Map Box</a>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Unrealscript"> Unrealscript</a> <ul>
<li> <a href="MOBAKitMinimap.html#UDKMOBAMinimapInterface"> UDKMOBAMinimapInterface</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#UDKMOBAGFxMinimapIconObject"> UDKMOBAGFxMinimapIconObject </a> <ul>
<li> <a href="MOBAKitMinimap.html#Variables"> Variables</a>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#UDKMOBAGFx_HUD"> UDKMOBAGFx_HUD</a> <ul>
<li> <a href="MOBAKitMinimap.html#Variables"> Variables</a>
</li> <li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Example implementation"> Example implementation</a> <ul>
<li> <a href="MOBAKitMinimap.html#UDKMOBACreepPawn"> UDKMOBACreepPawn</a>
</li></ul>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Mini map Frustum"> Mini map Frustum </a> <ul>
<li> <a href="MOBAKitMinimap.html#Flash"> Flash</a> <ul>
<li> <a href="MOBAKitMinimap.html#MOBAMinimapLineDrawing"> MOBAMinimapLineDrawing</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Unrealscript"> Unrealscript</a> <ul>
<li> <a href="MOBAKitMinimap.html#UDKMOBAGFx_HUD"> UDKMOBAGFx_HUD</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#UDKMOBAGFxMinimapLineDrawingObject"> UDKMOBAGFxMinimapLineDrawingObject</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li> <li> <a href="MOBAKitMinimap.html#Variables"> Variables</a>
</li></ul>
</li></ul>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Mini map Ping"> Mini map Ping</a> <ul>
<li> <a href="MOBAKitMinimap.html#Unrealscript"> Unrealscript</a> <ul>
<li> <a href="MOBAKitMinimap.html#UDKMOBAGFx_HUD"> UDKMOBAGFx_HUD</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li></ul>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Mini map Commands"> Mini map Commands</a> <ul>
<li> <a href="MOBAKitMinimap.html#Unrealscript"> Unrealscript</a>
</li></ul>
</li> <li> <a href="MOBAKitMinimap.html#Mini map Drawing"> Mini map Drawing</a> <ul>
<li> <a href="MOBAKitMinimap.html#Unrealscript"> Unrealscript</a> <ul>
<li> <a href="MOBAKitMinimap.html#Functions"> Functions</a>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
The mini map is GUI tool which provides information about the world to the player in an accessible way.
<p />
<img src="rsrc/Three/MOBAKitMinimap/MinimapOverview.jpg" alt="MinimapOverview.jpg" width='373' height='329' />
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> Very little Actionscript was used in this mini map as it is desirable to minimize the locations of logic.
<p />
<h2><a name="Feature Set"></a> Feature Set </h2>
<hr size="1" noshade="noshade">
The mini maps features are:
<p /> <ul>
<li> Common interface to allow any kind of Actor to be represented on the mini map.
</li> <li> Uses Scaleform; thus it is cross platform and allows any kind of animation per icon.
</li> <li> Allows players to ping on the mini map that is then received by other clients. <ul>
<li> PC users must hold down the Ctrl button and then left click on the mini map to produce a ping. Or they can use the P shortcut to ping where their current hero location is.
</li> <li> Mobile users must press the ping button located on the mini map chrome first, and then tap some where on the mini map to produce a ping.
</li> <li> Console users do not currently have this functionality.
</li></ul>
</li> <li> Allows arbitrary drawing onto the mini map. <ul>
<li> PC users must hold down the Alt button and then left click and drag. As they move the mouse cursor around, lines are drawn.
</li> <li> Mobile users must press the pencil button located on the mini map chrome first, and then tap and drag on the mini map to draw.
</li> <li> Console users do not currently have this functionality.
</li></ul>
</li> <li> Allows players to click any where within the mini map to move the camera there. <ul>
<li> Mobile camera system uses a spring, as a locked camera system is used normally. Thus the camera will shift to the location on the mini map touch; but will spring back when the mini map is no longer touched.
</li> <li> Console users do not currently have this functionality.
</li></ul>
</li></ul>
<p />
<h2><a name="Mini Map Icons"></a> Mini Map Icons </h2>
<hr size="1" noshade="noshade">
<p />
<h3><a name="Flash"></a> Flash </h3>
<hr size="1" noshade="noshade">
<p />
<h4><a name="Mini Map Icons"></a> Mini Map Icons </h4>
<p />
<a href="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapIcon.jpg"><img src="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapIcon_Thumb.jpg" alt="UDKMOBA_Flash_MinimapIcon_Thumb.jpg" width='800' height='433' /></a>
<p />
The mini map icons are stored in Flash as images. An external copy is also stored as PNGs so that Unreal Editor can also import those. You can optionally make animating mini map icons by adding in more frames in between each different icon. The mini map chooses the right mini map icons by asking the associated Actor (more information below) which frame to go to when displaying the movie clip.
<p />
<a href="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapSymbol.jpg"><img src="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapSymbol_Thumb.jpg" alt="UDKMOBA_Flash_MinimapSymbol_Thumb.jpg" width='800' height='433' /></a>
<p />
There are two mini map icons which represents units and towers. These are also set by asking the associated Actor (more information below) which symbol to choose when attaching the movie clip.
<p />
<h4><a name="Mini Map Area"></a> Mini Map Area </h4>
<p />
<a href="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapArea.jpg"><img src="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapArea_Flash.jpg" alt="UDKMOBA_Flash_MinimapArea_Flash.jpg" width='800' height='433' /></a>
<p />
The mini map area is split up into several layers. The layers were used to preserve the rendering order:
<p /> <ul>
<li> <strong>actions</strong> - This layer contains the Actionscript for the mini map.
</li> <li> <strong>CLIK</strong> - This layer contains the CLIK widgets for the mini map. It is important for CLIK widgets to be on the top most layer otherwise other layers can block the CLIK widget from receiving events from the mouse / touch.
</li> <li> <strong>button</strong> - This layer contains the mini map button which is used to capture mouse clicks or touch events.
</li> <li> <strong>frustum</strong> - This layer is used to draw the camera frustum.
</li> <li> <strong>linedrawing</strong> - This layer is used to draw arbitrary lines on the mini map.
</li> <li> <strong>minimap</strong> - This layer is used for rendering the mini map icons and mini map texture.
</li> <li> <strong>chrome</strong> - This layer is used for rendering the chrome around the mini map.
</li></ul>
<p />
<h4><a name="Mini Map Box"></a> Mini Map Box </h4>
<p />
<a href="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapBox.jpg"><img src="rsrc/Three/MOBAKitMinimap/UDKMOBA_Flash_MinimapBox_Thumb.jpg" alt="UDKMOBA_Flash_MinimapBox_Thumb.jpg" width='800' height='433' /></a>
<p />
The mini map box is the movie clip where all of the mini map icons. The layers are setup so that the rendering order is maintained between categories of mini map icons.
<p /> <ul>
<li> <strong>actions</strong> - This layer contains the Actionscript for the mini map.
</li> <li> <strong>ping_icons</strong> - This layer contains all of the ping mini map icon movie clips.
</li> <li> <strong>hero_icons</strong> - This layer contains all of the hero mini map icon movie clips.
</li> <li> <strong>courier_icons</strong> - This layer contains all of the courier mini map icon movie clips.
</li> <li> <strong>creep_icons</strong> - This layer contains all of the creep mini map icon movie clips.
</li> <li> <strong>tower_icons</strong> - This layer contains all of the tower mini map icon movie clips.
</li> <li> <strong>building_icons</strong> - This layer contains all of the building mini map icon movie clips.
</li> <li> <strong>jungle_creep_icons</strong> - This layer contains all of the jungle creep icon movie clips.
</li> <li> <strong>minimap_portrait</strong> - This layer contains the mini map texture which shows an birds eye view of the world.
</li></ul>
<p />
The icons layers are referenced in Unrealscript (more below) and are used to instance the mini map icons. The minimap_portrait layer contains the image that can be swapped out for another texture when the levels change.
<p />
<h3><a name="Unrealscript"></a> Unrealscript </h3>
<hr size="1" noshade="noshade">
Unrealscript just handles the instancing and updating of the mini map icons. As Scaleform is used for this, Unrealscript is not at all responsible for rendering or animating the mini map icons at all.
<p />
<h4><a name="UDKMOBAMinimapInterface"></a> UDKMOBAMinimapInterface </h4>
UDKMOBAMinimapInterface is a common interface which allows any actor implementing it to be displayed on the mini map and also allows it to modify the mini map icon. This allows individualistic modifications to mini map icons such as changing color, changing animation type.
<h5><a name="Functions"></a> Functions </h5> <ul>
<li> <strong>GetMinimapLayer()</strong> - This returns an enum, defined within UDKMOBAMinimapInterface, which indicates on which layer this mini map icon should be instanced within. This allows finer control over how mini map icons should blend on the mini map. This is useful when you have important mini map icons which should always be drawn on top of other mini map icons.
</li> <li> <strong>IsVisibleOnMinimap()</strong> - This returns true/false if the mini map icon should be visible or not. For example, if a Pawn needs to remove its mini map icon because it died; then it would return false when its health is or below zero. Otherwise it would return true.
</li> <li> <strong>GetActor()</strong> - This returns the Actor that is implementing this interface. This allows you store an array of Interfaces instead of Actors to reduce type casting.
</li> <li> <strong>GetMinimapMovieClipSymbolName()</strong> - This returns the AS Linkage name used by a MovieClip stored within Flash. This allows the code to instance different mini map icon MovieClips at the Actor's request.
</li> <li> <strong>UpdateMinimapIcon()</strong> - This allows the Interface to modify its own mini map icon MovieClip. It could apply further offsets, change MovieClip parameters, play different animations, etc.
</li></ul>
<p />
<h4><a name="UDKMOBAGFxMinimapIconObject"></a> UDKMOBAGFxMinimapIconObject </h4>
<h5><a name="Variables"></a> Variables </h5> <ul>
<li> <strong>MinimapIconMCSymbolName</strong> - Stores the name of the mini map icon MovieClip symbol name which can be used as an identifier.
</li> <li> <strong>MinimapInterface</strong> - Stores the mini map interface which this mini map icon represents. Saves having to type cast from the MinimapActor.
</li> <li> <strong>MinimapActor</strong> - Stores the actor which this mini map icon represents.
</li> <li> <strong>IsVisible</strong> - Stores whether this mini map icon is visible or not.
</li> <li> <strong>FrameName</strong> - Stores the frame name that this MovieClip is currently in.
</li></ul>
<p />
<h4><a name="UDKMOBAGFx_HUD"></a> UDKMOBAGFx_HUD </h4>
Most of the actual work of updating the mini map is done within the GFx HUD class.
<p />
<h5><a name="Variables"></a> Variables </h5> <ul>
<li> <strong>MinimapAreaMC</strong> - Cached GFxObject which points to the mini map area MovieClip.
</li> <li> <strong>MinimapMC</strong> - Cached GFxObject which points to the mini map MovieClip.
</li> <li> <strong>MinimapIconMCLayers</strong> - An array of all of the layers within the mini map (<strong>MinimapMC</strong>). <ul>
<li> <strong>MinimapIcons</strong> - An array of all of the <strong>UDKMOBAGFxSpellIconObject</strong> instances that are within this layer.
</li> <li> <strong>LayerMC</strong> - Cached GFxObject which points to the mini map MovieClip.
</li> <li> <strong>LayerMCWidth</strong> - Cached width of the <strong>LayerMC</strong>, this is in pixel coordinates within Flash resolution space.
</li> <li> <strong>LayerMCHeight</strong> - Cached height of the <strong>LayerMC</strong>, this is in pixel coordinates within Flash resolution space.
</li> <li> <strong>LayerMCName</strong> - Name of the MovieClip to look up when initializing this layer.
</li> <li> <strong>Layer</strong> - Enum that this layer represents. Must be unique within this array!
</li></ul>
</li> <li> <strong>MinimapIconIndex</strong> - An index which is used to ensure that unique instance names are generated for the mini map names.
</li> <li> <strong>MinimapInterfaces</strong> - An array of all of the mini map actor interfaces in the world.
</li></ul>
<p />
<h5><a name="Functions"></a> Functions </h5>
<strong>ConfigHUD()</strong> is called when the GFx HUD is initializing. Here is where all of the persistent MovieClips are initialized and cached in Unrealscript as GFxObjects. All of the mini map layers are initialized here, by using what has been defined in the default properties. <strong>AddMinimapInterface()</strong> and <strong>RemoveMinimapInterface()</strong> are functions which allow other classes to modify the <strong>MinimapInterfaces</strong> array. This done so that tight control of the <strong>MinimapInterfaces</strong> array is maintained, as other classes should not be able to add and remove entries whenever they feel like. Additional checks to make sure duplicates and null entries are also check. <strong>Tick()</strong> is called from <strong>UDKMOBAHUD::PostRender()</strong> and is passed <strong>RenderDelta</strong> as the delta time. Within <strong>Tick()</strong>, <strong>UpdateMinimap()</strong> is then called. <strong>UpdateMinimap()</strong> is the main loop which updates the mini map icons.
<p /> <ul>
<li> <strong>UpdateMinimap()</strong> - There are first some early out checks to ensure that the update loop has everything that it needs. These early outs check if the local PlayerController, the local PlayerController's HUD and the Map's UDKMOBAMapInfo are all valid. From here we copy the <strong>MinimapInterfaces</strong> array to <strong>ProcessingMinimapInterfaces</strong> which contains references to all of the minimap interfaces that needs to be updated. Next, the <strong>MinimapIconMCLayers</strong> array is iterated through, and on each iteration each layer is updated one by one. In each layer, we then iterate through each of the actors stored in the layer. As we process and update the mini map icon location, we then remove it from the <strong>ProcessingMinimapInterfaces</strong> array. If the mini map icon's associated actor is not supposed to be visible on the mini map then the icon is hidden using <strong>SetVisible(false)</strong>. The first iteration resolves mini map interfaces that already exist within the mini map layers. Any remaining entries in <strong>ProcessingMinimapInterfaces</strong> needs to be added to the appropriate mini map layer. By iterating through <strong>ProcessingMinimapInterfaces</strong> and then adding or replacing existing mini map icons we can add new mini map icons as needed. We also recycle old created mini map icons which were previously hidden.
</li></ul>
<p />
<h3><a name="Example implementation"></a> Example implementation </h3>
<hr size="1" noshade="noshade">
<p />
<h4><a name="UDKMOBACreepPawn"></a> UDKMOBACreepPawn </h4>
<div class="codetitlebar">
UDKMOBAPawn.uc
</div>
<div class="codesnippet">
<pre>
//&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
// UDKMOBAPawn
//
// MOBA base pawn to create hero/creep pawn archetypes used by the game. Has
// a lot of base functionality that are common to creeps/heroes.
//
// &#42; Has weapon properties, UDKMOBA doesn&#39;t need to use the weapon system
//   which comes with UE3 as a simplier method will suffice.
// &#42; Has mana properties which are used for spells and so forth.
// &#42; Has effects which happen when moving through water and other physical
//   material effects.
// &#42; Has teleport properties which are used when spawning.
// &#42; Handles a lot of base stats used in most MOBA style games.
// &#42; Handles creation of the screen space bounding box.
// &#42; Handles the occlusion mesh effect when the pawn is hidden from view on the
//   PC.
//
// Copyright 1998-2012 Epic Games, Inc. All Rights Reserved.
//&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
class UDKMOBAPawn extends Pawn
  Abstract
  HideCategories(Movement, Camera, Debug, Attachment, Physics, Advanced, Object)
  Implements(UDKMOBAMinimapInterface, UDKMOBATouchInterface, UDKMOBAAttackInterface, UDKMOBAStatsInterface, UDKMOBACommandInterface)
  Placeable;

// Snip

// Flash symbol name to use on the minimap
var(GFx) const string MinimapMovieClipSymbolName;

// Snip

/&#42;&#42;
 &#42; Called when the pawn is initialized
 &#42;
 &#42; &#64;network    Server and client
 &#42;/
simulated event PostBeginPlay()
{
  local int i;
  local PlayerController PlayerController;
  local UDKMOBAHUD UDKMOBAHUD;

  // Snip

  PlayerController &#61; GetALocalPlayerController();
  if (PlayerController !&#61; None)
  {
    // Add myself to the local player controller&#39;s HUD
    UDKMOBAHUD &#61; UDKMOBAHUD(PlayerController.MyHUD);
    if (UDKMOBAHUD !&#61; None)
    {
      if (UDKMOBAHUD.HUDMovie !&#61; None)
      {
        UDKMOBAHUD.HUDMovie.AddMinimapInterface(Self);
      }
    }
  }

  // Snip
}

// Snip

/&#42;&#42;
 &#42; This pawn has died
 &#42;
 &#42; &#64;param  Killer       Who killed this pawn
 &#42; &#64;param  DamageType   What killed it
 &#42; &#64;param  HitLocation  Where did the hit occur
 &#42; &#64;return              Returns true if the pawn died
 &#42;/
function bool Died(Controller Killer, class&#60;DamageType&#62; DamageType, vector HitLocation)
{
  local PlayerController PlayerController;
  local UDKMOBAHUD UDKMOBAHUD;

  // Snip

  PlayerController &#61; GetALocalPlayerController();
  if (PlayerController !&#61; None)
  {
    UDKMOBAHUD &#61; UDKMOBAHUD(PlayerController.MyHUD);
    if (UDKMOBAHUD !&#61; None)
    {
      if (UDKMOBAHUD.HUDMovie !&#61; None)
      {
        UDKMOBAHUD.HUDMovie.RemoveMinimapInterface(Self);
      }
    }
  }

  // Snip
}

// &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
// UDKMOBAMinimapInterface implementation
// &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
/&#42;&#42;
 &#42; Returns whether or not this actor is still valid to be rendered on the mini map
 &#42;
 &#42; &#64;return      Returns true if the mini map should render this actor or not
 &#42; &#64;network      Server and client
 &#42;/
simulated function bool IsVisibleOnMinimap()
{
  return (Health &#62; 0);
}

/&#42;&#42;
 &#42; Returns the name of the movie clip symbol to instance on the minimap
 &#42;
 &#42; &#64;return      Returns the name of the movie clip symbol to instance on the minimap
 &#42; &#64;network      Server and client
 &#42;/
simulated function String GetMinimapMovieClipSymbolName()
{
  return MinimapMovieClipSymbolName;
}
</pre>
</div>
<p />
When pawns are instanced they add themselves to the GFx HUD's mini map interfaces array. When pawns have been killed they remove themselves from the GFx HUD's mini map interfaces array. This is a fast method of automatically adding and removing mini map actors, and saved from having to continually poll for UDKMOBAMinimapInterfaces in the world. <strong>IsVisibleOnMinimap()</strong> returns true if the health is above zero, and also returns the <strong>MinimapMovieClipSymbolName</strong> in <strong>GetMinimapMovieClipSymbolName()</strong>. <strong>MinimapMovieClipSymbolName</strong> is an Editor exposed string variable.
<p />
<div class="codetitlebar">
UDKMOBACreepPawn.uc
</div>
<div class="codesnippet">
<pre>
//&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
// UDKMOBACreepPawn
//
// Variation of UDKMOBAPawn which is used for the creeps in the world. Creeps
// have a sight range, they give money when they are killed, give experience
// to heroes when killed and are owned by a creep factory placed in the map.
//
// Copyright 1998-2012 Epic Games, Inc. All Rights Reserved.
//&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
class UDKMOBACreepPawn extends UDKMOBAPawn;

// Snip

// &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
// UDKMOBAMinimapInterface implementation
// &#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;
/&#42;&#42;
 &#42; Returns what layer this actor should have it&#39;s movie clip in Scaleform
 &#42;
 &#42; &#64;return      Returns the layer enum
 &#42; &#64;network      Server and client
 &#42;/
simulated function EMinimapLayer GetMinimapLayer()
{
  return EML&#95;Creeps;
}

/&#42;&#42;
 &#42; Updates the minimap icon
 &#42;
 &#42; &#64;param      MinimapIcon      GFxObject which represents the minimap icon
 &#42; &#64;network                  Server and client
 &#42;/
simulated function UpdateMinimapIcon(UDKMOBAGFxMinimapIconObject MinimapIcon)
{
  local PlayerController PlayerController;
  local string DesiredFrameName;

  PlayerController &#61; GetALocalPlayerController();
  if (PlayerController !&#61; None)
  {
    DesiredFrameName &#61; (PlayerController.GetTeamNum() &#61;&#61; GetTeamNum()) ? &#34;friendly&#34; : &#34;enemy&#34;;
    if (DesiredFrameName !&#61; MinimapIcon.FrameName)
    {
      MinimapIcon.GotoAndStop(DesiredFrameName);
    }
  }
}
</pre>
</div>
<p />
UDKMOBACreepPawn further defines <strong>GetMinimapLayer()</strong> and <strong>UpdateMinimapIcon()</strong>. <strong>GetMinimapLayer()</strong> returns the Creeps enum layer so that all creeps will be placed in the same layer. <strong>UpdateMinimapIcon()</strong> changes the frame that the MovieClip is at. If the creep is friendly towards the local player controller, is on the same team, then the MovieClip is told to play the "friendly" animation. Otherwise, the MovieClip is told to play the "enemy" animation.
<p />
<p />
<hr size="1" noshade="noshade">
<p />
<p />
<h2><a name="Mini map Frustum"></a> Mini map Frustum </h2>
<hr size="1" noshade="noshade">
The mini map frustum is a rendered box on the mini map which represents the camera view. This indicates to the player the area of the map that the game is currently showing. While you can draw arbitrary lines on the Canvas, it is more desirable to be able to draw the lines using Actionscript. This allows the UI designer to indicate at which layer he/she wishes to have the camera frustum drawn in, and also apply other effects as well.
<p />
<h3><a name="Flash"></a> Flash </h3>
<hr size="1" noshade="noshade">
<p />
<h4><a name="MOBAMinimapLineDrawing"></a> MOBAMinimapLineDrawing </h4>
<h5><a name="Functions"></a> Functions </h5> <ul>
<li> <strong>drawLine()</strong> - Draws a line on the movie clip using the Flash Graphics interface.
</li> <li> <strong>clear()</strong> - Clears all of the drawn lines on the movie clip using the Flash Graphics interface.
</li></ul>
<p />
<h3><a name="Unrealscript"></a> Unrealscript </h3>
<hr size="1" noshade="noshade">
<p />
<h4><a name="UDKMOBAGFx_HUD"></a> UDKMOBAGFx_HUD </h4>
<h5><a name="Functions"></a> Functions </h5>
<strong>ConfigHUD()</strong> is called when the GFx HUD is initializing. Here is where all of the persistent MovieClips are initialized and cached in Unrealscript as GFxObjects/GFxClikObjects. <strong>Tick()</strong> is called from <strong>UDKMOBAHUD::PostRender()</strong> and is passed <strong>RenderDelta</strong> as the delta time. Within <strong>Tick()</strong>, <strong>UpdateMinimapFrustum()</strong> is called. <strong>UpdateMinimapFrustum()</strong> is the main loop which updates the mini map frustum.
<p /> <ul>
<li> <strong>UpdateMinimapFrustum()</strong> - This is the main update camera frustum update loop. We first ensure that the function has access to the local PlayerController, the local PlayerController's HUD and the Map's MapInfo. Next, the player view point is grabbed. The resultant <strong>CameraLocation</strong> and <strong>CameraRotation</strong> represent the player's camera location and rotation. From here, by peeking into the local game viewport client, we can get the current viewport size. This then can be used to represent the game view. 0.f; 0.f represents the top left corner 0.f; ViewportSize.X represents the top right corner and so forth. By deprojecting the screen coordinates, we the trace vector parameters needed to find the world location that the pixel coordinate represents. From here, it is trivial to convert the location from world space to mini map space. Once each of the four frustum coordinates are in mini map space, we send them to <strong>MinimapFrustumMC</strong> which is able to draw lines in Scaleform.
</li></ul>
<p />
<h4><a name="UDKMOBAGFxMinimapLineDrawingObject"></a> UDKMOBAGFxMinimapLineDrawingObject </h4>
<h5><a name="Functions"></a> Functions </h5> <ul>
<li> <strong>Init()</strong> - This function initializes the widget by setting the <strong>Width</strong>, <strong>Height</strong>, <strong>HalfWidth</strong> and <strong>HalfHeight</strong>.
</li> <li> <strong>DrawLine()</strong> - This function draws a line on the MovieClip. This is a wrapper function for the Actionscript function called <strong>drawLine</strong>.
</li> <li> <strong>Clear()</strong> - This function clears all of the lines draw on the MovieClip. This is a wrapper function for the Actionscript function called <strong>clear</strong>.
</li></ul>
<p />
<h5><a name="Variables"></a> Variables </h5> <ul>
<li> <strong>Width</strong> - Cached width of the movie clip.
</li> <li> <strong>Height</strong> - Cached height of the movie clip.
</li> <li> <strong>HalfWidth</strong> - Cached half width of the movie clip.
</li> <li> <strong>HalfHeight</strong> - Cached half height of the movie clip.
</li></ul>
<p />
<p />
<hr size="1" noshade="noshade">
<p />
<p />
<h2><a name="Mini map Ping"></a> Mini map Ping </h2>
<hr size="1" noshade="noshade">
Pinging on the mini map allows you to indicate to other players where something important is happening. The ping can also be generated by in game events, such as when the towers are being attacked.
<p />
<img src="rsrc/Three/MOBAKitMinimap/MinimapPinging.jpg" alt="MinimapPinging.jpg" width='373' height='329' />
<p />
<h3><a name="Unrealscript"></a> Unrealscript </h3>
<hr size="1" noshade="noshade">
<h4><a name="UDKMOBAGFx_HUD"></a> UDKMOBAGFx_HUD </h4>
<h5><a name="Functions"></a> Functions </h5> <ul>
<li> <strong>PerformPingUsingWorldSpaceCoordinates()</strong> - This function converts the location in world space to screen space which is then forwarded to <strong>PerformPingUsingScreenSpaceCoordinates().</strong>
</li> <li> <strong>PerformPingUsingScreenSpaceCoordinates()</strong> - This function automatically converts from screen space to mini map space and then displays an animated movie clip on the mini map. The mini map is colored as the player's color that sent the ping.
</li></ul>
<p />
<p />
<hr size="1" noshade="noshade">
<p />
<p />
<h2><a name="Mini map Commands"></a> Mini map Commands </h2>
<hr size="1" noshade="noshade">
The mini map can also be used as a command interface to perform movement, attacks or to follow friendly units. This is achieved on the PC platform by right clicking on the mini map. On the mobile platform this is done by setting the correct radio button and then tapping on the mini map.
<p />
<h3><a name="Unrealscript"></a> Unrealscript </h3>
<hr size="1" noshade="noshade">
As Flash does not intercept the right mouse button, we initially have to intercept the right mouse button using Unrealscript. We then grab the coordinates of the mouse at the time of the right click and then process the command from there.
<p />
On the PC the right mouse click is first intercepted at <strong>UDKMOBAPlayerController_PC::PlayerCommanding::StartFire()</strong> when <strong>FireModeNum</strong> is 1. This sets <strong>UDKMOBAHUD_PC.PendingRightClickCommand</strong> to true. When <strong>UDKMOBAHUD_PC::PostRender()</strong> is called from native code, it calls <strong>UDKMOBAHUD_PC::ProcessCommands()</strong>. This function processes all pending commands. If <strong>UDKMOBAGFx_HUD.bCapturingMouseInput</strong> is true, then the right click is passed to UDKMOBAGFx_HUD. <strong>UDKMOBAGFx_HUD.bCapturingMouseInput</strong> is set true, when the mini map receives the mouse over event. <strong>UDKMOBAGFx_HUD::HandlePendingRightClickCommand()</strong> checks if the mouse is within the mini map bounds. If it is, it then calls <strong>UDKMOBAGFx_HUD::PerformMoveUsingMinimap()</strong>. <strong>UDKMOBAGFx_HUD::PerformMoveUsingMinimap()</strong> converts the mini map space location to world location, and then sends the move command.
<p />
On Mobile the touch events are first stored in an array called <strong>TouchEvents</strong> from <strong>UDKMOBAPlayerController_Mobile::InternalOnInputTouch()</strong>. When <strong>UDKMOBAHUD_Mobile::PostRender()</strong> is called by native code, this calls <strong>UDKMOBAHUD_Mobile::ProcessTouchEvents()</strong>. This function iterates through all of the <strong>TouchEvents</strong>, and if <strong>UDKMOBAGFx_HUD.MinimapButtonPressed</strong> is true, then it routes the touch event to the HUD. <strong>UDKMOBAGFx_HUD.MinimapButtonPressed</strong> is set true, when the mini map has been touched.
<p />
<p />
<hr size="1" noshade="noshade">
<p />
<p />
<h2><a name="Mini map Drawing"></a> Mini map Drawing </h2>
<hr size="1" noshade="noshade">
The mini map can also be used to draw on. This can be used by players to indicate to other players that something is happening in that area. On the PC platform, the player should hold down Shift and the left click and drag to draw lines. On the Mobile platform, the player selects the appropriate radio button and then taps and drags the mini map to draw. The line is colorized in the color that the player has been assigned.
<p />
<img src="rsrc/Three/MOBAKitMinimap/MinimapDrawing.jpg" alt="MinimapDrawing.jpg" width='373' height='329' />
<p />
<h3><a name="Unrealscript"></a> Unrealscript </h3>
<hr size="1" noshade="noshade">
On the PC platform, the player presses and holds the Shift key to initiate drawing mode for the mini map. This is done by simply binding a key press and release to an exec function and setting a boolean, <strong>UDKMOBAPlayerController_PC.TrackMouseWhileLeftMouseButtonIsHeld</strong>. When <strong>UDKMOBAPlayerController_PC::PostRender()</strong> is called (passed on from <strong>UDKMOBAHUD::PostRender()</strong>). It asks the HUD's mini map line drawing movie clip to draw using screen space coordinates by calling <strong>UDKMOBAGFxMinimapLineDrawingObject::DrawUsingScreenSpaceCoordinates()</strong>.
<p />
<h4><a name="Functions"></a> Functions </h4> <ul>
<li> <strong>UDKMOBAGFxMinimapLineDrawingObject.DrawUsingScreenSpaceCoordinates()</strong> - This functions draws a connecting line using the last recorded position and the new incoming position.
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
