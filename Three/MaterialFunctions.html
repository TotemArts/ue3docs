<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | MaterialFunctions    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">MaterialFunctions  </b></div>
<div id="tooltext">
<a href="MaterialFunctionsJP.html" class="twikiLink">日本語訳</a><br><a href="https://udn.epicgames.com/Three/MaterialFunctionsCH" class="restricted" class="restricted" class="twikiLink">中国翻译</a><br><a href="MaterialFunctionsKR.html" class="twikiLink">한국어</a><br>

<!-- Three/MaterialFunctions -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="MaterialsAndTexturesHome.html" class="twikiLink">Materials &amp; Textures</a></b> &gt; Material Functions
</div>
<hr size="1" noshade="noshade">
<h1><a name="Material Functions"></a> Material Functions </h1>
<hr size="1" noshade="noshade">
<p />
<noautolink>
<p />
<em>Document Changelog: Created by <a href="https://udn.epicgames.com/Main/DanielWright" class="restricted" class="restricted" class="twikiLink">Daniel Wright</a>.</em>
<p />
<div class="twikiToc"> <ul>
<li> <a href="MaterialFunctions.html#Material Functions"> Material Functions</a> <ul>
<li> <a href="MaterialFunctions.html#Overview"> Overview</a>
</li> <li> <a href="MaterialFunctions.html#Function basics and quick setup"> Function basics and quick setup</a>
</li> <li> <a href="MaterialFunctions.html#Propagation"> Propagation</a>
</li> <li> <a href="MaterialFunctions.html#Organization"> Organization</a> <ul>
<li> <a href="MaterialFunctions.html#Material function library"> Material function library</a>
</li></ul>
</li> <li> <a href="MaterialFunctions.html#Previewing"> Previewing</a>
</li> <li> <a href="MaterialFunctions.html#Parameters"> Parameters</a>
</li> <li> <a href="MaterialFunctions.html#Function related nodes"> Function related nodes</a>
</li> <li> <a href="MaterialFunctions.html#Advanced"> Advanced</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<p />
Material Functions are little snippets of material graphs that can be saved in packages and reused across multiple materials.  They are edited in the material editor like a normal material, but with some restrictions on what nodes can be used.  When used properly, they can reduce material redundancy which in turn reduces artist maintenance effort keeping those duplicate expressions in sync, and the inevitable bugs that arise when one duplicate is missed during a modification.
<p />
<h2><a name="Function basics and quick setup"></a> Function basics and quick setup </h2>
<p />
Functions are created through the content browser just like a material.  Right click in an empty area and choose New Material Function.
<p />
Functions define their interface to any materials they are used in by function inputs and outputs, which are just nodes that you place in the function.  Inputs and outputs can be named, so that people using the function in their materials know what they mean.  There must be at least one output for a function to be valid, and input and output names must be unique.
<p />
<img alt="FunctionNodes.jpg" src="rsrc/Three/MaterialFunctions/FunctionNodes.jpg" />
<p />
The heart of the function is what it does between those inputs and outputs.  This example takes two layers and blends them together like a <a href="http://www.webdesign.org/photoshop/photoshop-basics/using-blend-modes-screen.14859.html" target="_top">photoshop screen blend</a>.  The function abstracts the details from an artist that might want to use it, so they don't have to actually know the math of a screen blend to use a screen blend operation.  If anyone wants to change the way the screen blend operation works later, they can do so to this function and the change will automatically be propagated to all materials that use it.
<p />
<img alt="ScreenBlendFunction.jpg" src="rsrc/Three/MaterialFunctions/ScreenBlendFunction.jpg" />
<p />
Once you make changes to a function you have to click the apply button to propagate the changes to the function asset and any materials using the function.
<p />
To use a function in a material, simply drag and drop the function's icon from the content browser into the material.  Alternatively you can hold down F and click in the material editor with the function selected in the content browser.  This creates a MaterialFunctionCall node which references the function asset you created.  Then you need to connect nodes to the inputs and connect the outputs to where ever you want it to be used in the material.
<p />
<img alt="ScreenBlendInMaterial.jpg" src="rsrc/Three/MaterialFunctions/ScreenBlendInMaterial.jpg" />
<p />
Inputs have a specified type that is required of any expressions connected to them, which is displayed in a few letters next to the input connectors when the function is used in a material.  In this case both the inputs were vector3's so V3 is displayed.  Anything connected to an input when used in a material must be convertible to the input type.
<p />
<h2><a name="Propagation"></a> Propagation </h2>
<p />
When you edit a function and click apply changes, the new version is propagated to any loaded materials or functions which reference this function.  Any unloaded materials which reference the function will be updated with the changes when they are next loaded.
<p />
<strong>When an input or output is deleted from a function and the changes are propagated, any links to these deleted connectors in materials that use the function will be broken!</strong>  It's important to be aware of this, because the propagation can't be undone.  The more materials a function is used in, the bigger the potential for breakage, so be careful.
<p />
All loaded materials that use the function will be marked dirty when the function change is propagated, which can be used to see which packages could be resaved to prevent increased load times.  You can find all the loaded materials which use a function by right clicking in the content browser and choosing this option:
<p />
<img alt="FindUsingMaterials.jpg" src="rsrc/Three/MaterialFunctions/FindUsingMaterials.jpg" />
<p />
<h2><a name="Organization"></a> Organization </h2>
<p />
Functions are expected to be created by a few people, but used by many people, so it's important to have good documentation of what the functions do, and what values are needed for their inputs and outputs.  For this reason, functions have several documentation fields on top of the function name and input/output names:
<p /> <ul>
<li> <strong>Function description</strong> - Click on an empty area to see the function's properties, where Description is located.  <strong>If you are going to fill in only one description field, make it this one!</strong>  It will be displayed as a tooltip anywhere that the function is shown (content browser, material function library, function call node).
</li> <li> <strong>Input / output descriptions</strong> - These are located on the input and output nodes in a function.  They show up as tooltips when hovering over the function call node's inputs and outputs.
</li></ul>
<p />
Function Description filled out:
<p />
<img alt="FunctionProperties2.jpg" src="rsrc/Three/MaterialFunctions/FunctionProperties2.jpg" />
<p />
Corresponding tooltip when used in a material:
<p />
<img alt="FunctionTooltip.jpg" src="rsrc/Three/MaterialFunctions/FunctionTooltip.jpg" />
<p />
<h3><a name="Material function library"></a> Material function library </h3>
<p />
The material editor has a window called the Material function library, which contains a categorized and filterable list of available material functions.  This list is populated from any loaded functions, but also from any functions which were not loaded but were found through the <a href="ContentBrowserDatabase.html" class="twikiLink">ContentBrowserDatabase</a> which is used by the Content Browser.
<p />
<img alt="MaterialFunctionLibrary.jpg" src="rsrc/Three/MaterialFunctions/MaterialFunctionLibrary.jpg" />
<p />
You can hover over these entries to see their Description as a tooltip, or drag and drop one into your material.  For a function to show up in the function library, it needs to have the bExposeToLibary value checked in the function's properties.
<p />
<img alt="FunctionProperties.jpg" src="rsrc/Three/MaterialFunctions/FunctionProperties.jpg" />
<p />
Be sure to specify meaningful library categories, and try to reuse existing categories instead of creating new ones.
<p />
<h2><a name="Previewing"></a> Previewing </h2>
<p />
When editing a material function, the preview window shows whichever node is being previewed.  Most of the time you will want to preview a function output.
<p />
<img alt="PreviewingOutput.jpg" src="rsrc/Three/MaterialFunctions/PreviewingOutput.jpg" />
<p />
Function input nodes have some options for specifying preview values, since they don't know the actual values they will be used with in a material.  Each input has a built in PreviewValue can be used to show a constant for float input types.  Function inputs also have a 'Preview' connector which allows you to override that built in value with any value that matches the input's type.  In this example a texture sample has been used to provide the preview for a float 3 input.
<p />
<img alt="PreviewTexture.jpg" src="rsrc/Three/MaterialFunctions/PreviewTexture.jpg" />
<p />
In this example, a Static Bool node is being used to provide a default value for a static bool input.
<p />
<img alt="PreviewStaticBool.jpg" src="rsrc/Three/MaterialFunctions/PreviewStaticBool.jpg" />
<p />
Note that the input has an option called "Use Preview Value As Default".  When this is enabled, the preview value will be used any time the function is used in a material and nothing is connected to that input, instead of causing a compilation error.  This makes the input an optional input, so it is drawn in gray.
<p />
<h2><a name="Parameters"></a> Parameters </h2>
<p />
Functions are not allowed to contain parameter node types, as this would cause name conflicts with other functions declaring the same name, but you can still use parameters by passing in the values through inputs.  To use a vector or scalar parameter value with a function, simply pass it in as a function input vector type.
<p />
To use a texture parameter with a function, make a texture input and connect it to the texture object override in a texture sample node:
<p />
<img alt="TextureParameterFunction.jpg" src="rsrc/Three/MaterialFunctions/TextureParameterFunction.jpg" />
<p />
Then in the material that uses the function, place a TextureObjectParameter node and connect it to the texture input:
<p />
<img alt="TextureParameterMaterial.jpg" src="rsrc/Three/MaterialFunctions/TextureParameterMaterial.jpg" />
<p />
Similarly for static switch parameters, make a static bool input and connect it to a StaticSwitch node:
<p />
<img alt="StaticSwitchFunction.jpg" src="rsrc/Three/MaterialFunctions/StaticSwitchFunction.jpg" />
<p />
Then in the material that uses the function, place a StaticBoolParameter node and connect it to the static bool input:
<p />
<img alt="StaticSwitchMaterial.jpg" src="rsrc/Three/MaterialFunctions/StaticSwitchMaterial.jpg" />
<p />
<h2><a name="Function related nodes"></a> Function related nodes </h2>
<p /> <ul>
<li> <strong>MaterialFunctionCall</strong> - Allows using an external function from another material or function.  The external function's input and output nodes become inputs and outputs of the function call node.
</li> <li> <strong>FunctionInput</strong> - Can only be placed in a material function, where it defines one of the function's inputs.
</li> <li> <strong>FunctionOutput</strong> - Can only be placed in a material function, where it defines one of the function's outputs.
</li> <li> <strong>TextureObject</strong> - Useful for providing a default texture for a texture function input within a function.  This node does not actually sample the texture, so it must be used in conjunction with a TextureSample node.
</li> <li> <strong>TextureObjectParameter</strong> - Defines a texture parameter and outputs the texture object, used in materials that call a function with texture inputs.  This node does not actually sample the texture, so it must be used in conjunction with a TextureSample node.
</li> <li> <strong>StaticSwitch</strong> - Performs a compile time choice between two inputs, based on the input value.
</li> <li> <strong>StaticBool</strong> - Useful for providing a default bool value for a static bool function input within a function.  This node does not switch between anything, so it must be used in conjunction with a StaticSwitch node.
</li> <li> <strong>StaticBoolParameter</strong> - Defines a static bool parameter and outputs the static bool value, used in materials that call a function with static bool inputs.  This node does not switch between anything, so it must be used in conjunction with a StaticSwitch node.
</li></ul>
<p />
<h2><a name="Advanced"></a> Advanced </h2>
<p />
Functions can be nested (function within a function) and chained together arbitrarily, except that they must not create a circular dependency.
<p />
Compile errors within a function will highlight the MaterialFunctionCall node in red in materials that use it.  The error message will also say what function the error occurred in.  In this example, the error is that the function's inputs have not been connected.
<p />
<img alt="CompileErrors0.jpg" src="rsrc/Three/MaterialFunctions/CompileErrors0.jpg" />
<p />
The function's inputs have now been connected, but according to the error message there is an error with an Add node within the function.
<p />
<img alt="CompileErrors1.jpg" src="rsrc/Three/MaterialFunctions/CompileErrors1.jpg" />
<p />
Double click the function to open the editor for it, where the Add node is highlighted with red due to the error:
<p />
<img alt="CompileErrors2.jpg" src="rsrc/Three/MaterialFunctions/CompileErrors2.jpg" />
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
