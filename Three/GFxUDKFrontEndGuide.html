<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | GFxUDKFrontEndGuide    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">GFxUDKFrontEndGuide  </b></div>
<div id="tooltext">
<a href="GFxUDKFrontEndGuideJP.html" class="twikiLink">日本語訳</a><br><a href="GFxUDKFrontEndGuideCH.html" class="twikiLink">中国翻译</a><br><a href="GFxUDKFrontEndGuideKR.html" class="twikiLink">한국어</a><br>

<!-- Three/GFxUDKFrontEndGuide -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<style type="text/css" media="all">@import "rsrc/UDNCSS_test.css";</style>
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="UIAndHUDHome.html" class="twikiLink">User Interfaces &amp; HUDs</a></b> &gt; <b><a href="Scaleform.html" class="twikiLink">Scaleform GFx</a></b> &gt; Making sense of GFx UDKFrontEnd
</div>
<hr size="1" noshade="noshade">
<p />
<h1><a name="Making sense of GFx _UDKFrontEnd"></a> Making sense of GFx UDKFrontEnd </h1>
<hr size="1" noshade="noshade">
<p />
<div class="twikiToc"> <ul>
<li> <a href="GFxUDKFrontEndGuide.html#Making sense of GFx _UDKFrontEnd"> Making sense of GFx UDKFrontEnd</a> <ul>
<li> <a href="GFxUDKFrontEndGuide.html#Overview"> Overview</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#Files Involved"> Files Involved</a> <ul>
<li> <a href="GFxUDKFrontEndGuide.html#Unreal Script Files Involved"> Unreal Script Files Involved</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#Flash Files Involved"> Flash Files Involved</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#ActionScript Files Involved"> ActionScript Files Involved</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#Other Files"> Other Files</a>
</li></ul>
</li> <li> <a href="GFxUDKFrontEndGuide.html#GFxUDKFrontEnd Call Stack"> GFxUDKFrontEnd Call Stack</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#MenuManager Call Stack"> MenuManager Call Stack</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#&quot;Popping&quot; a View"> "Popping" a View</a>
</li> <li> <a href="GFxUDKFrontEndGuide.html#Downloads"> Downloads</a>
</li></ul>
</li></ul>
</div>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
This is a step by step, high level explanation of how GFxUDKFrontEnd loads and displays each view of the menu which ships with UDK.
<p />
This <a href="GFxUDKFrontEndGuide.html#Downloads" class="twikiAnchorLink">simplified version</a> illustrates the code and assets needed for pushing and popping two views (Main Menu and Options) to a view stack, using a menu manager. It contains custom files and assets (not covered below, but similar in execution).
<p />
<img src="rsrc/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" /> <strong>Note:</strong> Add the following two lines to [Engine.PackagesToForceCookPerMap] in DefaultEngine.ini.
<p />
<div class="codetitlebar">
DefaultEngine.ini
</div>
<div class="codesnippet">
<pre>
.Map&#61;SF-FrontEnd
.Package&#61;SFSandbox
</pre>
</div>
<p />
<h2><a name="Files Involved"></a> Files Involved </h2>
<hr size="1" noshade="noshade">
<p />
<h3><a name="Unreal Script Files Involved"></a> Unreal Script Files Involved </h3> <ul>
<li> The Menu Manager - \Development\Src\UTGame\GFxUDKFrontEnd.uc
</li> <li> The Views - \Development\Src\UTGame\GFxUDKFrontEnd_MainMenu.uc , *Multiplayer.uc, *Settings.uc, etc.
</li> <li> Base class for Views - Development\Src\UTGame\GFxUDKFrontEnd_Screen.uc
</li> <li> Base View class - \Development\Src\UTGame\GFxUDKFrontEnd_View.uc
</li></ul>
<p />
<h3><a name="Flash Files Involved"></a> Flash Files Involved </h3> <ul>
<li> The Manager - \UDKGame\Flash\UDKFrontEnd\udk_manager.fla
</li> <li> The Views - \UDKGame\Flash\UDKFrontEnd\udk_main_menu.fla, *multiplayer.fla, *settings.fla, etc.
</li> <li> All graphical assets pulled from this file - \UDKGame\Flash\UDKFrontEnd\udk_assets.fla
</li></ul>
<p />
<p />
<h3><a name="ActionScript Files Involved"></a> ActionScript Files Involved </h3> <ul>
<li> The Views - \UDKGame\Flash\ActionScript\com\scaleform\udk\view s\MainMenuView.as, MultiplayerView.as, SettingsView.as, etc.
</li> <li> The Manager - \UDKGame\Flash\ActionScript\com\scaleform\udk\mana gers\MenuManager.as
</li> <li> Utlility for registering a document's class - \UDKGame\Flash\ActionScript\com\scaleform\udk\util s\UDKUtils.as
</li></ul>
<p />
<p />
<h3><a name="Other Files"></a> Other Files </h3> <ul>
<li> \UDKGame\Config\DefaultUI.ini
</li> <li> \UDKGame\Content\Maps\UT3\UDKFrontEndMap.udk
</li></ul>
<p />
<p />
GFxUDKFrontEnd.uc is the master class (or manager) for the front end (menu). It is called in the startup level (UDKFrontEndMap) in Kismet via Open GFx Movie. The Movie loaded there is: UDKFrontEnd.udk_manager, and the Movie Player Class is set to GFxUDKFrontEnd. Take Focus, Capture Input, and Display With Hud Off are all checked.
<p />
<p /> <ul>
<li> GFxUDKFrontEnd’s SWF is defined in defaultproperties as: UDKFrontEnd.udk_manager
</li> <li> udk_manager.FLA/SWF is given the document class of: com’scaleform.udk.managers.MenuManager (MenuManager.as) <ul>
<li> MenuManager.as initializes the _viewStack array and provides several functions for tweening (animating) the viewstack.
</li> <li> udk_manager.FLA contains the empty movieClip: manager which is of type: manager. This movieClip will be used to hold the views.
</li></ul>
</li></ul>
<p />
<h2><a name="GFxUDKFrontEnd Call Stack"></a> GFxUDKFrontEnd Call Stack </h2>
<hr size="1" noshade="noshade">
<p /> <ul>
<li> Creates ViewInfo data structure <ul>
<li> ViewName, SwfName, and DependantViews
</li> <li> These values will be populated by data in DefaultUI.ini
</li></ul>
</li> <li> Creates ViewData[] array of type ViewInfo <ul>
<li> +ViewData lines defined in DefaultUI.ini
</li></ul>
</li> <li> <strong>Start()</strong> is executed <ul>
<li> Calls <strong>ConfigFrontEnd()</strong>
</li></ul>
</li> <li> <strong>ConfigFrontEnd()</strong> is executed <ul>
<li> “_root” of udk_manager.fla is cached in RootMC
</li> <li> “manager” from udk_manager.fla is cached in ManagerMC
</li></ul>
</li> <li> <strong>Start()</strong> calls <strong>LoadViews()</strong>
</li> <li> <strong>LoadViews()</strong> is executed <ul>
<li> Calls <strong>LoadView()</strong> passing each element (each view) of the ViewData[] array
</li></ul>
</li> <li> <strong>LoadView()</strong> is executed <ul>
<li> A new empty movieclip is created inside ManagerMC with the name: SomeViewNameContainer (example: MainMenuContainer, MultiplayerContainer, HostGameContainer, etc.) <ul>
<li> And this new movieclip is referenced by ViewContainer
</li></ul>
</li> <li> A new empty movie clip is then created inside the ViewContainer with the name: SomeViewName. <ul>
<li> This new movieclip is referenced by ViewLoader.
</li></ul>
</li> <li> We get the SWFName and store at element 0 of the args[] array of asvals as a string.
</li> <li> We then invoke “loadMovie” (a standard Flash function in a GFxObject) on ViewLoader, passing it the SWFName via the args[] array. <ul>
<li> This loads the actual SWF file for that view into the ViewLoader movie clip as a new movie clip.
</li> <li> The SWF files sets their document class (example: com.scaleform.udk.views.MainMenuView (MainMenuView.as))
</li> <li> The SWFs contain an empty movie clip of type container with the instance name: “container” <ul>
<li> Inside “container” is another movie clip which is loaded via runtime sharing. “udk_main_menu.fla” for instance has the “main_menu” movie clip of type main_menu. <ul>
<li> These movie clips have been imported into the SWF via runtime sharing from udk_assets.swf
</li> <li> UDK_assets.swf contains all the views in the library, and each view is setup to export for runtime sharing in the properties.
</li></ul>
</li></ul>
</li> <li> The newly loaded SWF fires off a CLIK WidgetInitialized event
</li></ul>
</li> <li> Finally, we add the name of the view to the LoadedViews[] array.
</li></ul>
</li> <li> <strong>WidgetInitialized()</strong> is executed for each loaded view as they are loaded. <ul>
<li> Example: MainMenu <ul>
<li> MainMenuView is created of type GFxUDKFrontEnd_MainMenu
</li> <li> Calls <strong>ConfigureView()</strong>
</li> <li> <strong>ConfigureView()</strong> is executed. <ul>
<li> <strong>SetWidgetPathBinding()</strong> is called - this function sets it up so that all child widget's found in the view's path will send their initCallBack events to the view's <strong>WidgetInitialized()</strong> handler. <ul>
<li> This requires using SubWidgetBindings.Add instead of the usual WidgetBindings.Add in the default properties when binding a widget.
</li></ul>
</li></ul>
</li> <li> Calls <strong>ConfigureTargetView()</strong> (only for MainMenuView)
</li></ul>
</li></ul>
</li> <li> <strong>ConfigureTargetView()</strong> is executed (for the first view ? main menu) <ul>
<li> This function first tests to see if the view is already on the stack or not.
</li> <li> Calls <strong>OnViewActivated()</strong> (found in GFxUDKFrontEnd_View.uc)
</li> <li> Calls <strong>OnTopMostView()</strong>, passing true. <ul>
<li> <strong>OnTopMostView()</strong> plays the open animation &amp; sets the escape key delegate.
</li></ul>
</li> <li> Adds the view to the UnrealScript ViewStack[] array.
</li> <li> Calls <strong>PushView()</strong>.
</li></ul>
</li> <li> <strong>PushView()</strong> is executed. <ul>
<li> Fires off the ActionScript function <strong>pushStandardView()</strong> in MenuManager.as, passing it the new view.
</li></ul>
</li></ul>
<p />
<h2><a name="MenuManager Call Stack"></a> MenuManager Call Stack </h2>
<hr size="1" noshade="noshade"> <ul>
<li> <strong>pushStandardView()</strong> is executed. <ul>
<li> Calls <strong>pushViewImpl()</strong>
</li></ul>
</li> <li> <strong>pushViewImpl()</strong> is executed. <ul>
<li> Tweens the new view into place.
</li> <li> Pushes the new view onto the _viewStack[] array in AS.
</li></ul>
</li></ul>
<p />
<p />
<h2><a name="&quot;Popping&quot; a View"></a> "Popping" a View </h2>
<hr size="1" noshade="noshade">
When a view is "popped" off the viewstack, as when pressing BACK to go from the Multiplayer screen to the Main Menu, the essential functions used are:
<p /> <ul>
<li> <strong>PopView()</strong>
</li> <li> <strong>PopViewStub()</strong>
</li></ul>
<p /> <ul>
<li> Each Screen has a "Back" button. The Back button is bound in GFxUDKFrontEnd_Screen.uc in the defaultproperites:
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
defaultproperties
{
  // General
  SubWidgetBindings.Add((WidgetName&#61;&#34;list&#34;,WidgetClass&#61;class&#39;GFxClikWidget&#39;))
  SubWidgetBindings.Add((WidgetName&#61;&#34;back&#34;,WidgetClass&#61;class&#39;GFxClikWidget&#39;))

  AcceptButtonImage&#61;&#34;pc&#95;enter&#95;png&#34;
  CancelButtonImage&#61;&#34;pc&#95;esc&#95;png&#34;
  AcceptButtonHelpText&#61;&#34;SELECT&#34;
  CancelButtonHelpText&#61;&#34;BACK&#34;
}
</pre>
</div>
<p /> <ul>
<li> In the <strong>WidgetInitialized()</strong> handler of GFxUDKFrontEnd_Screen.uc, the Back button is told to listen for 'CLIK_press' events, and to execute <strong>Select_Back()</strong> on press.:
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
case (&#39;back&#39;):
  BackBtn &#61; GFxClikWidget(Widget.GetObject(&#34;btn&#34;, class&#39;GFxClikWidget&#39;));
  BackBtn.SetString(&#34;label&#34;, &#34;BACK&#34;);
  BackBtn.AddEventListener(&#39;CLIK&#95;press&#39;, Select&#95;Back);
  BackBtn.AddEventListener(&#39;CLIK&#95;focusIn&#39;, FocusIn&#95;BackButton);
  bWasHandled &#61; true;
  break;
</pre>
</div>
<p /> <ul>
<li> The event handler <strong>Select_Back()</strong> is found in GFxUDKFrontEnd_View. It fires off the function <strong>MoveBackImpl()</strong>:
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
function Select&#95;Back(GFxClikWidget.EventData ev)
{
  MoveBackImpl();
}
</pre>
</div>
<p /> <ul>
<li> <strong>MoveBackImpl()</strong> executes <strong>PopView()</strong> from the MenuManager (GFxUDKFrontEnd.uc)
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
function MoveBackImpl()
{
  if (MenuManager !&#61; none)
  {
    PlayCloseAnimation();
    MenuManager.PopView();
  }
}
</pre>
</div>
<p /> <ul>
<li> <strong>PopView()</strong> removes the current view from the ViewStack[] array.
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
ViewStack.Remove(ViewStack.Length-1, 1);
</pre>
</div>
<p /> <ul>
<li> It then executes the <strong>OnTopMostView()</strong> function of the previous view (which is now the current view).
</li></ul>
<p />
<div class="codetitlebar">
Unrealscript
</div>
<div class="codesnippet">
<pre>
ViewStack&#91;ViewStack.Length-1].OnTopMostView( false );
</pre>
</div>
<p /> <ul>
<li> Last of all, it executes the <strong>PopViewStub()</strong> function as its return value.
</li> <li> <strong>PopViewStub()</strong> executes the <strong>popView()</strong> ActionScript function found in MenuManager.as
</li> <li> <strong>popView()</strong> then executes <strong>popViewImpl()</strong> which tweens the movie out.
</li></ul>
<p />
<h2><a name="Downloads"></a> Downloads </h2>
<hr size="1" noshade="noshade"> <ul>
<li> <a href="rsrc/Three/GFxUDKFrontEndGuide/FrontEnd_SimpleExample.zip" target="_top">Download</a> the simplified version of GFxUDKFrontEnd.
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
