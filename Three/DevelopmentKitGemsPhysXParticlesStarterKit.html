<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> UDK | DevelopmentKitGemsPhysXParticlesStarterKit    </title>

<style type="text/css" media="all">@import "rsrc/twiki_webs.css";</style>
<style type="text/css" media="all">@import "rsrc/udn_new.css";</style>
<link rel="icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="rsrc/Three/WebPreferences/favicon.ico" type="image/x-icon" />


<!-- view.static_udn3.tmpl  -->
<script language="JavaScript" type="text/javascript" src="rsrc/udn.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<p />
<body id="webbgThree">
<p />

<p />
<div id="webThree"><div id="head">
<!--
<div class="header">
 -->
<div style="background: url(/pub/webbg_udn.jpg); background-repeat: no-repeat; height:140px; width: 100%;" >
<!--
<div style="background: transparent url(/pub/udn_header_bg.jpg); background-repeat: repeat-x; height:140px; width: 100%; margin-left: 991px;">
 -->
<p />
<div id="nav">
<ul class="nav">
<font color=black>|</font>&nbsp;&nbsp;<li class=nav_Three><a href="../Main/WebHome.html" class="twikiLink">Main</a></li><font color=black>|</font><li class=nav_Three><a href="../Two/WebHome.html" class="twikiLink">UnrealEngine2</a></li><font color=black>|</font><li class=nav_Three><a href="WebHome.html" class="twikiLink">UnrealEngine3</a></li><font color=black>|</font><li class=nav_Three><a href="https://docs.unrealengine.com" class="twikiLink">UnrealEngine4</a></li><font color=black>|</font><li class=nav_Three><a href="../Main/BusinessAndLegal.html" class="twikiLink">Business &amp; Legal</a></li><font color=black>|</font>
</ul><br><br><br>
</div>
</div>
</div> <!-- end head -->
<div id="pagedefault">
<div id="maincol">
<div id="tool">
<div id="tooltop">UDN</div>
<div id="tooltext" style="padding: 10px 10px 10px 10px;">
Search public documentation: <br>
<form ACTION="/search/index.php" METHOD="GET" NAME="main" ID="main">
<input TYPE="TEXT" NAME="q" SIZE="15" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;">
<input TYPE="SUBMIT" VALUE="Search" STYLE="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: xx-small;"><br>
</form>
</div>
<div id="toolband">DevelopmentKitGemsPhysXParticlesStarterKit  </b></div>
<div id="tooltext">
<a href="DevelopmentKitGemsPhysXParticlesStarterKitJP.html" class="twikiLink">日本語訳</a><br><a href="https://udn.epicgames.com/Three/DevelopmentKitGemsPhysXParticlesStarterKitCH" class="restricted" class="restricted" class="twikiLink">中国翻译</a><br><a href="DevelopmentKitGemsPhysXParticlesStarterKitKR.html" class="twikiLink">한국어</a><br>

<!-- Three/DevelopmentKitGemsPhysXParticlesStarterKit -->
<hr size="1" noshade="noshade" />
Interested in the Unreal Engine? <br>
Visit the <a href="http://www.unrealtechnology.com" target="_top">Unreal Technology</a> site.<br>
<br>
Looking for jobs and company info? <br>
Check out the <a href="http://www.epicgames.com" target="_top">Epic games</a> site.<br>
<br>
Questions about support via UDN? <br>
Contact the <a href="../Main/ContactUDNStaff.html" class="twikiLink">UDN Staff</a> <br>
<br>
</div> <!-- end toolbox content -->
<div id="toolbottom"></div>
</div> <!-- end tool -->
<p />
<noautolink>
<p />
<div style="padding:0px 0px 0px 4px;font:10px Verdana;">
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="DevelopmentKitGems.html" class="twikiLink">Unreal Development Kit Gems</a></b> &gt; PhysX Particles Starter Kit <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="GettingStartedProgramming.html" class="twikiLink">Getting Started: Programming</a> </b> &gt; PhysX Particles Starter Kit <br/>
<b><a href="WebHome.html" class="twikiLink">UE3 Home</a></b> &gt; <b><a href="PhysicsHome.html" class="twikiLink">Physics Home</a> </b> &gt; PhysX Particles Starter Kit <br/>
</div>
<hr size="1" noshade="noshade">
<h1><a name="PhysX Particles Starter Kit"></a> PhysX Particles Starter Kit </h1>
<hr size="1" noshade="noshade">
<p />
<strong><em>Last tested against UDK November, 2011</em></strong>
<p />
<div class="twikiToc"> <ul>
<li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#PhysX Particles Starter Kit"> PhysX Particles Starter Kit</a> <ul>
<li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#Overview"> Overview</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#What's included?"> What's included?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#Content and Code Structure"> Content and Code Structure</a> <ul>
<li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#How do I create a _PhysX Particle System?"> How do I create a PhysX Particle System?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#How do I connect my particle system to the weapon?"> How do I connect my particle system to the weapon?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#How do I make UTGame select my new weapons?"> How do I make UTGame select my new weapons?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#What are drains and why do we need them?"> What are drains and why do we need them?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#Player collision with particles"> Player collision with particles</a>
</li></ul>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#How to use this starter kit?"> How to use this starter kit?</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#How to enable NVIDIA Hardware Acceleration"> How to enable NVIDIA Hardware Acceleration</a>
</li> <li> <a href="DevelopmentKitGemsPhysXParticlesStarterKit.html#Downloads"> Downloads</a>
</li></ul>
</li></ul>
</div>
<p />
<style type="text/css" media="all">@import "rsrc/UDNCSS_test.css";</style>
<p />
<h2><a name="Overview"></a> Overview </h2>
<hr size="1" noshade="noshade">
<p />
This starter kit provides an example of adding PhysX Particles to the UTGame example provided with UDK.  The technique in this document uses the Mutator functionality provided in UTGame.  PhysX particles are unique in that they collide with the surrounding environment, increasing the realism of the special effects and adding to player immersion.
<p />
<img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_01.jpg" alt="PxPrt_01.jpg" width='620' height='340' />
<p />
<h2><a name="What's included?"></a> What's included? </h2>
<hr size="1" noshade="noshade">
<p /> <ul>
<li> <strong>PhysX particle versions of weapons effects</strong> - PhysX particles have been added to the following weapons <ul>
<li> <strong>Rocket Launcher</strong> - Red-hot rocks explode outward and cool as they come to rest on the ground
</li> <li> <strong>Link Gun</strong> - Glowing green crystal shards burst from each impact from the primary fire, green sparks from the secondary fire
</li> <li> <strong>Shock Rifle</strong> - Purple sparks from the primary fire
</li></ul>
</li> <li> <strong>PhysX Weapon Mutator (UTMutator_PhysXWeapons.uc)</strong> - Class which will replace existing weapons with the PhysX versions
</li> <li> <strong>Weapons Replacement Map (DefaultPhysXMod.ini)</strong> - ini file that contains the mapping of old weapons to new weapons
</li> <li> <strong>Drain (UTDrain.uc)</strong> - Placed in the level to catch any particles that may fall through the world
</li></ul>
<p />
The majority of the code simply connects the PhysX Particles effects by using the defaultproperties.  Please download the code and content in the download link at the bottom of this page. The rest of this document will explain how it's structured to allow you to further expand on this starter kit and create your own PhysX particle effects.
<p />
<h2><a name="Content and Code Structure"></a> Content and Code Structure </h2>
<hr size="1" noshade="noshade">
<p />
<h3><a name="How do I create a _PhysX Particle System?"></a> How do I create a PhysX Particle System? </h3>
<p />
PhysX mesh particle systems are created in Cascade by creating a particle system and changing the <strong>TypeData</strong> to be <strong>New PhysX Mesh Data.</strong>  In order to adjust the physical behavior of the particle system you will want to create a new <strong>PhysXParticleSystem</strong> and connect it to your emitter that is using the PhysX Mesh Data.  Try to share the <strong>PhysXParticleSystem</strong> across several emitters as this is more efficient for simulation (e.g. rock and metal debris particles can probably both use the same <strong>PhysXParticleSystem</strong>).
<p /> <ul>
<li> Changing the data type to use PhysX: <br />     <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_02.jpg" alt="PxPrt_02.jpg" width='444' height='403' />
</li></ul>
<p /> <ul>
<li> This is the location where you link your PhysXParticleSystem to your PhysX emitter: <br />     <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_06.JPG" alt="PxPrt_06.JPG" width='512' height='384' />
</li></ul>
<p /> <ul>
<li> The physical parameters of the PhysXParticleSystem: <br />     <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_04.jpg" alt="PxPrt_04.jpg" width='512' height='640' />
</li></ul>
<p />
<h3><a name="How do I connect my particle system to the weapon?"></a> How do I connect my particle system to the weapon? </h3>
<p />
For this example we are using UTGame, which already has the weapons defined.  You could change the original classes to make use of these particle systems, however, that would change the behavior of the original game.  By using the Mutator functionality, we can turn the PhysX particle additions into a mod for players to enable if desired.
<p />
The first thing we need to do is create a version of the weapon that uses the PhysX particle system.  As an example we will look at the <strong>UTProj_RocketPhysX.uc</strong> file.  You can see that this class derives from the original <strong>UTProj_Rocket.uc</strong> class and overrides the <strong>ProjExplosionTemplate</strong> in the <strong>defaultproperties</strong> section of the code.  We will derive classes for other weapons and projectiles in this manner until we have connected all of our PhysX Particles systems.
<p />
<div class="codetitlebar">
UTProj_RocketPhysX.uc
</div>
<div class="codesnippet">
<pre>
class UTProj&#95;RocketPhysX extends UTProj&#95;Rocket;

defaultproperties
{
  ProjExplosionTemplate&#61;ParticleSystem&#39;WP&#95;RocketLauncher&#95;PhysX.Effects.P&#95;WP&#95;RocketLauncher&#95;RocketExplosion&#39;
}
</pre>
</div>
<p />
<h3><a name="How do I make UTGame select my new weapons?"></a> How do I make UTGame select my new weapons? </h3>
<p />
As we mentioned earlier we will be using the Mutator functionality to make this happen.  There are a few key files involved.
<p /> <ul>
<li> The <strong>DefaultPhysXMod.ini</strong> contains a list of weapons and their replacements.  This is where you will be specifying which original weapons you want to replace with your new version.   <div class="codetitlebar">DefaultPhysXMod.ini</div>   <div class="codesnippet">   <pre>
&#91;PhysXMod.UTMutator&#95;PhysXWeapons]
WeaponsToReplace&#61;(OldClassName&#61;&#34;UTWeap&#95;LinkGun&#34;,NewClassPath&#61;&#34;PhysXMod.UTWeap&#95;LinkGunPhysX&#34;)
WeaponsToReplace&#61;(OldClassName&#61;&#34;UTWeap&#95;RocketLauncher&#95;Content&#34;,NewClassPath&#61;&#34;PhysXMod.UTWeap&#95;RocketLauncher&#95;ContentPhysX&#34;)
WeaponsToReplace&#61;(OldClassName&#61;&#34;UTWeap&#95;ShockRifle&#34;,NewClassPath&#61;&#34;PhysXMod.UTWeap&#95;ShockRiflePhysX&#34;)
   </pre>   </div>
</li> <li> The <strong>UTMutator_PhysXWeapons</strong> class extends the base <strong>UTMutator</strong> class and implements the <strong>PostBeginPlay</strong> function.  In this function, you can see it search the game inventory looking for weapons to replace with the new versions.  It uses the values you entered in the <strong>DefaultPhysXMod.ini</strong> file by specifying the <strong>WeaponsToReplace</strong> variable with the <strong>config</strong> keyword.  It must perform another check on the weapons if they are picked up in game, and it does this in the <strong>CheckReplacement</strong> function
</li> <li> In order to get the new Mutator to display in the menu you must create the <strong>UTUIDataProvider_Mutator</strong> in <strong>PhysXMod.ini</strong>.  Finally, you must provide it with a <strong>FriendlyName</strong> and <strong>Description</strong> in the <strong>PhysXMod.int</strong> file.
</li></ul>
<p />
<h3><a name="What are drains and why do we need them?"></a> What are drains and why do we need them? </h3>
<p />
Drains are shapes that will delete PhysX particles when they come into contact with them.  Depending on how your level and particle systems are set up, it may be possible for particles to leave the map and fall forever beneath the world.  This can cause performance and rendering problems.  In order to avoid this, we created a few special shapes which we could load under the level to catch any stray falling particles.  The <strong>UTDrain</strong> class will set the proper defaults in order to make the shapes into drains.  The <strong>PostBeginPlay</strong> function in <strong>UTMutator_PhysXWeapons</strong> will load the proper drain based on the level name.  You can see this happen just below the weapon replacement code.
<p />
<h3><a name="Player collision with particles"></a> Player collision with particles </h3>
<p />
In this demo we do not have the players colliding with the particles, but you may want to do that in your game depending on the effect.  Physical smoke is a good example where interaction is important.  In order to do this follow these steps: <ol>
<li> Add a Physics Asset to your skeletal mesh
</li> <li> Set "Has Physics Asset Instance" to true
</li> <li> Set "BlockRigidBody" to true
</li> <li> Ensure that the PhysX Particles are on the same channel as the skeletal mesh
</li></ol>
<p />
<h2><a name="How to use this starter kit?"></a> How to use this starter kit? </h2>
<hr size="1" noshade="noshade">
<p /> <ol>
<li> <a href="http://www.udk.com/download">Download</a> UDK.
</li> <li> Install UDK.
</li> <li> <a href="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PhysX_Particle_Mutator.zip" target="_top">Download</a> the zip file.
</li> <li> Unzip the contents into your UDK base directory. (<em>e.g</em> C:\UDK\UDK-2011-11\) Windows may inform you that you may be overwriting existing files or folders. Click "Ok" on all of them.
</li> <li> Open up <strong>DefaultEngine.ini</strong> inside the <strong>UDKGame\Config</strong> directory with Notepad. (<em>e.g</em> C:\UDK\UDK-2011-11\UDKGame\Config\DefaultEngine.ini)
</li> <li> Search for <strong>EditPackages</strong>.
</li> <li> Add <strong>+ModEditPackages=PhysXMod</strong> <br /> <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_03.jpg" alt="PxPrt_03.jpg" width='564' height='536' />
</li> <li> Click on <strong>UDK Game</strong> on the Start Menu and you should see a message asking you if you want to recompile scripts.  Select "Yes."  After UDK has finished building scripts, close the window. <br /> <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_07.JPG" alt="PxPrt_07.JPG" width='399' height='175' />
</li> <li> Click on <strong>UDK Game</strong> on the Start Menu to open UDK.
</li> <li> Select <strong>Instant Action</strong> from the menu
</li> <li> Select <strong>Mutators</strong> <br /> <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_08.jpg" alt="PxPrt_08.jpg" width='643' height='371' />
</li> <li> Click on <strong>PhysX Weapons</strong> <br /> <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_09.jpg" alt="PxPrt_09.jpg" width='642' height='327' />
</li> <li> Select <strong>Back</strong>
</li> <li> Select <strong>Start Game</strong>
</li> <li> When you fire your weapons you should see the PhysX Particles emitting from weapon impacts and colliding with the environment.
</li></ol>
<p />
With the PhysX Particles starter kit set up, you can see the benefit that particle collisions add to a game.  Using the techniques shown here you can add PhysX particles to your own game, or even see if you can make better effects for UTGame.  The Unrealscript code is located within <b>Development\Src\PhysXMod\Classes\*.uc</b>, and all of the content is contained within <strong>UDKGame\Content\UT3\PhysXMod</strong> folder.
<p />
<h2><a name="How to enable NVIDIA Hardware Acceleration"></a> How to enable NVIDIA Hardware Acceleration </h2>
<hr size="1" noshade="noshade">
<p /> <ul>
<li> Depending on how many particles you add to the environment and how long they live, you may notice significant performance improvements by enabling hardware acceleration.  This will only work with NVIDIA GPUs 8800 or higher.  Acceleration can be enabled by opening the <strong>Engine\Config\BaseEngine.ini</strong> file and setting the following variable to false: <strong>bDisablePhysXHardwareSupport=False</strong> <br/>
</li></ul>
<p />
   <img src="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PxPrt_HWAccel.JPG" alt="PxPrt_HWAccel.JPG" width='690' height='537' />
<p />
<h2><a name="Downloads"></a> Downloads </h2>
<hr size="1" noshade="noshade">
<p /> <ul>
<li> <a href="rsrc/Three/DevelopmentKitGemsPhysXParticlesStarterKit/PhysX_Particle_Mutator.zip" target="_top">Download</a> the code and content for this starter kit.
</li></ul>
<p />
</noautolink>
<p />
<p />
<p />
<p />
<p />
<p />


<!-- BEGIN UE4 NOTICE -->



<div id="version_message" style="display:none;">

    <div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;opacity:0.5;">

    </div>

    <div style="position:fixed;top:50%;left:50%;margin:-70px 0px 0px -240px;background:#FFF;border-radius:6px;width:480px;box-shadow:0px 5px 30px -5px rgba(0,0,0,0.9);">

        <div style="font-size:16px;font-weight:bold;background: url(rsrc/Three/warning.png) no-repeat scroll 5px 5px;padding:4px 10px 5px 25px;height:21px;width:440px;">

            Important!

        </div>

        <div style="font-size:11px;padding:5px 10px 10px;width:460px;">

            <p>You are viewing documentation for the <strong>Unreal Development Kit (UDK)</strong>.</p>



            <p>If you are looking for the Unreal Engine 4 documentation, please visit the <a style="color:#000;" href="https://docs.unrealengine.com">Unreal Engine 4 Documentation</a> site.</p>

        </div>

        <div style="height:20px;padding:4px;margin:6px;border-top:1px solid #a0a0a0;">

            <form onsubmit="return closeVersionMessage();">

                <input type="checkbox" id="dismiss" value="dismiss" />

                <label for="dsimiss">Don't show me this again</label>

                <input type="submit" value="Close" style="cursor:pointer;float:right;width:60px;color:#f0f0f0;font-weight:bold;background:#882222;height:24px;padding:2px 3px 3px;text-align:center;border:1px outset #000;" />

            </form>

        </div>

    </div>

</div>



<script type="text/javascript">

    window.onload = function () {

        LoadVersionMessage();

    }



    function LoadVersionMessage()

    {

        var showMessage = "false";
        if(showMessage != "false")

        {

            showVersionMessage();

        }

    }



    function showVersionMessage()

    {

        var message = document.getElementById("version_message");

        if(message)

        {

            message.style.display = "block";

        }

    }



    function closeVersionMessage() {

        var dismiss = document.getElementById("dismiss");

        var message = document.getElementById("version_message");

        if (message) {

            message.style.display = "none";

        }

        if (dismiss.checked) {

            eraseCookie("doc_version_message");

            createCookie("doc_version_message", "false", 365);

            dismiss.checked = false;

        }

        return false;

    }



    function createCookie(name, value, days) {

        if (days) {

            var date = new Date();

            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));

            var expires = "; expires=" + date.toGMTString();

        }

        else var expires = "";

        document.cookie = name + "=" + value + expires + "; path=/";

    }



    function readCookie(name) {

        var nameEQ = name + "=";

        var ca = document.cookie.split(';');

        for (var i = 0; i < ca.length; i++) {

            var c = ca[i];

            while (c.charAt(0) == ' ') c = c.substring(1, c.length);

            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);

        }

        return null;

    }



    function eraseCookie(name) {

        createCookie(name, "", -1);

    }

</script>



<!-- END UE4 NOTICE -->



</div></div><div id="footer"><div style="BACKGROUND-COLOR: transparent; margin: 0; padding: 0; width: 100%;"><div>&nbsp;</div><div style="float: left; text-align: left; vertical-align: bottom; width: 50%;"><a href="http://www.videogamevoters.org"><img src="rsrc/vgvn.jpg" border="0" width="234" height="60" alt="Video Game Voters Network" /></a></div><div style="float: right; text-align: right; vertical-align: bottom; width: 50%;">Copyright &copy; 2001-2012 <a href="http://www.epicgames.com" target="_top">Epic Games, Inc.</a><br /><a href="../Main/TermsAndConditions.html" class="twikiLink">Terms and Conditions</a><br /><a href="http://epicgames.com/privacynotice" target="_top">Privacy Notice</a></div></div></div></div>
<p />
</html></body>
